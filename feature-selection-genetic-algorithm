{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "MbsRofSN0Zg2"
   },
   "source": [
    "# Packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "id": "heDobMvK0Zg3"
   },
   "outputs": [],
   "source": [
    "import random\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "from sklearn.preprocessing import normalize\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.model_selection import StratifiedShuffleSplit, KFold, GridSearchCV, learning_curve, cross_val_score\n",
    "from sklearn.metrics import precision_score, recall_score, f1_score, accuracy_score, classification_report\n",
    "\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "zMm3x44t0Zg3"
   },
   "source": [
    "*Data source : https://www.kaggle.com/annavictoria/speed-dating-experiment*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "nE-GLOWq0Zg4"
   },
   "source": [
    "# EDA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 253
    },
    "id": "z0QAOP7q0Zg4",
    "outputId": "cc542866-ab76-4ed5-b369-0a22693da557"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iid</th>\n",
       "      <th>id</th>\n",
       "      <th>gender</th>\n",
       "      <th>idg</th>\n",
       "      <th>condtn</th>\n",
       "      <th>wave</th>\n",
       "      <th>round</th>\n",
       "      <th>position</th>\n",
       "      <th>positin1</th>\n",
       "      <th>order</th>\n",
       "      <th>...</th>\n",
       "      <th>attr3_3</th>\n",
       "      <th>sinc3_3</th>\n",
       "      <th>intel3_3</th>\n",
       "      <th>fun3_3</th>\n",
       "      <th>amb3_3</th>\n",
       "      <th>attr5_3</th>\n",
       "      <th>sinc5_3</th>\n",
       "      <th>intel5_3</th>\n",
       "      <th>fun5_3</th>\n",
       "      <th>amb5_3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7</td>\n",
       "      <td>...</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 195 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   iid   id  gender  idg  condtn  wave  round  position  positin1  order  ...  \\\n",
       "0    1  1.0       0    1       1     1     10         7       NaN      4  ...   \n",
       "1    1  1.0       0    1       1     1     10         7       NaN      3  ...   \n",
       "2    1  1.0       0    1       1     1     10         7       NaN     10  ...   \n",
       "3    1  1.0       0    1       1     1     10         7       NaN      5  ...   \n",
       "4    1  1.0       0    1       1     1     10         7       NaN      7  ...   \n",
       "\n",
       "   attr3_3  sinc3_3  intel3_3  fun3_3  amb3_3  attr5_3  sinc5_3  intel5_3  \\\n",
       "0      5.0      7.0       7.0     7.0     7.0      NaN      NaN       NaN   \n",
       "1      5.0      7.0       7.0     7.0     7.0      NaN      NaN       NaN   \n",
       "2      5.0      7.0       7.0     7.0     7.0      NaN      NaN       NaN   \n",
       "3      5.0      7.0       7.0     7.0     7.0      NaN      NaN       NaN   \n",
       "4      5.0      7.0       7.0     7.0     7.0      NaN      NaN       NaN   \n",
       "\n",
       "   fun5_3  amb5_3  \n",
       "0     NaN     NaN  \n",
       "1     NaN     NaN  \n",
       "2     NaN     NaN  \n",
       "3     NaN     NaN  \n",
       "4     NaN     NaN  \n",
       "\n",
       "[5 rows x 195 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('data/Speed Dating Data.csv', encoding=\"ISO-8859-1\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "rPjJWpeCJiya",
    "outputId": "8c7032e1-bc5c-4661-bc3b-c83946fb5fd4"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 8378 entries, 0 to 8377\n",
      "Columns: 195 entries, iid to amb5_3\n",
      "dtypes: float64(174), int64(13), object(8)\n",
      "memory usage: 12.5+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 346
    },
    "id": "AHJEBS8gJU6m",
    "outputId": "c0bf57f4-84d9-412d-910f-f43681e2f13a"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iid</th>\n",
       "      <th>id</th>\n",
       "      <th>gender</th>\n",
       "      <th>idg</th>\n",
       "      <th>condtn</th>\n",
       "      <th>wave</th>\n",
       "      <th>round</th>\n",
       "      <th>position</th>\n",
       "      <th>positin1</th>\n",
       "      <th>order</th>\n",
       "      <th>...</th>\n",
       "      <th>attr3_3</th>\n",
       "      <th>sinc3_3</th>\n",
       "      <th>intel3_3</th>\n",
       "      <th>fun3_3</th>\n",
       "      <th>amb3_3</th>\n",
       "      <th>attr5_3</th>\n",
       "      <th>sinc5_3</th>\n",
       "      <th>intel5_3</th>\n",
       "      <th>fun5_3</th>\n",
       "      <th>amb5_3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8377.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>6532.000000</td>\n",
       "      <td>8378.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>3974.000000</td>\n",
       "      <td>3974.000000</td>\n",
       "      <td>3974.000000</td>\n",
       "      <td>3974.000000</td>\n",
       "      <td>3974.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>283.675937</td>\n",
       "      <td>8.960248</td>\n",
       "      <td>0.500597</td>\n",
       "      <td>17.327166</td>\n",
       "      <td>1.828837</td>\n",
       "      <td>11.350919</td>\n",
       "      <td>16.872046</td>\n",
       "      <td>9.042731</td>\n",
       "      <td>9.295775</td>\n",
       "      <td>8.927668</td>\n",
       "      <td>...</td>\n",
       "      <td>7.240312</td>\n",
       "      <td>8.093357</td>\n",
       "      <td>8.388777</td>\n",
       "      <td>7.658782</td>\n",
       "      <td>7.391545</td>\n",
       "      <td>6.810020</td>\n",
       "      <td>7.615079</td>\n",
       "      <td>7.932540</td>\n",
       "      <td>7.155258</td>\n",
       "      <td>7.048611</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>158.583367</td>\n",
       "      <td>5.491329</td>\n",
       "      <td>0.500029</td>\n",
       "      <td>10.940735</td>\n",
       "      <td>0.376673</td>\n",
       "      <td>5.995903</td>\n",
       "      <td>4.358458</td>\n",
       "      <td>5.514939</td>\n",
       "      <td>5.650199</td>\n",
       "      <td>5.477009</td>\n",
       "      <td>...</td>\n",
       "      <td>1.576596</td>\n",
       "      <td>1.610309</td>\n",
       "      <td>1.459094</td>\n",
       "      <td>1.744670</td>\n",
       "      <td>1.961417</td>\n",
       "      <td>1.507341</td>\n",
       "      <td>1.504551</td>\n",
       "      <td>1.340868</td>\n",
       "      <td>1.672787</td>\n",
       "      <td>1.717988</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>154.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>6.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>281.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>16.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>407.000000</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>15.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>8.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>552.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>44.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>10.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8 rows × 187 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               iid           id       gender          idg       condtn  \\\n",
       "count  8378.000000  8377.000000  8378.000000  8378.000000  8378.000000   \n",
       "mean    283.675937     8.960248     0.500597    17.327166     1.828837   \n",
       "std     158.583367     5.491329     0.500029    10.940735     0.376673   \n",
       "min       1.000000     1.000000     0.000000     1.000000     1.000000   \n",
       "25%     154.000000     4.000000     0.000000     8.000000     2.000000   \n",
       "50%     281.000000     8.000000     1.000000    16.000000     2.000000   \n",
       "75%     407.000000    13.000000     1.000000    26.000000     2.000000   \n",
       "max     552.000000    22.000000     1.000000    44.000000     2.000000   \n",
       "\n",
       "              wave        round     position     positin1        order  ...  \\\n",
       "count  8378.000000  8378.000000  8378.000000  6532.000000  8378.000000  ...   \n",
       "mean     11.350919    16.872046     9.042731     9.295775     8.927668  ...   \n",
       "std       5.995903     4.358458     5.514939     5.650199     5.477009  ...   \n",
       "min       1.000000     5.000000     1.000000     1.000000     1.000000  ...   \n",
       "25%       7.000000    14.000000     4.000000     4.000000     4.000000  ...   \n",
       "50%      11.000000    18.000000     8.000000     9.000000     8.000000  ...   \n",
       "75%      15.000000    20.000000    13.000000    14.000000    13.000000  ...   \n",
       "max      21.000000    22.000000    22.000000    22.000000    22.000000  ...   \n",
       "\n",
       "           attr3_3      sinc3_3     intel3_3       fun3_3       amb3_3  \\\n",
       "count  3974.000000  3974.000000  3974.000000  3974.000000  3974.000000   \n",
       "mean      7.240312     8.093357     8.388777     7.658782     7.391545   \n",
       "std       1.576596     1.610309     1.459094     1.744670     1.961417   \n",
       "min       2.000000     2.000000     3.000000     2.000000     1.000000   \n",
       "25%       7.000000     7.000000     8.000000     7.000000     6.000000   \n",
       "50%       7.000000     8.000000     8.000000     8.000000     8.000000   \n",
       "75%       8.000000     9.000000     9.000000     9.000000     9.000000   \n",
       "max      12.000000    12.000000    12.000000    12.000000    12.000000   \n",
       "\n",
       "           attr5_3      sinc5_3     intel5_3       fun5_3       amb5_3  \n",
       "count  2016.000000  2016.000000  2016.000000  2016.000000  2016.000000  \n",
       "mean      6.810020     7.615079     7.932540     7.155258     7.048611  \n",
       "std       1.507341     1.504551     1.340868     1.672787     1.717988  \n",
       "min       2.000000     2.000000     4.000000     1.000000     1.000000  \n",
       "25%       6.000000     7.000000     7.000000     6.000000     6.000000  \n",
       "50%       7.000000     8.000000     8.000000     7.000000     7.000000  \n",
       "75%       8.000000     9.000000     9.000000     8.000000     8.000000  \n",
       "max      10.000000    10.000000    10.000000    10.000000    10.000000  \n",
       "\n",
       "[8 rows x 187 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 142
    },
    "id": "Fm23Qe0I0Zg5",
    "outputId": "f967f99d-c3ac-4071-dec9-7c39fbf04350"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>col_0</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>match</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>6998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1380</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "col_0  count\n",
       "match       \n",
       "0       6998\n",
       "1       1380"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.crosstab(index=df['match'],columns=\"count\") "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "TzR1a7WG0Zg5"
   },
   "source": [
    "By default, class 0 is over-represented in our target variable."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "vAxGsE6LHy3l"
   },
   "source": [
    "# Data Cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "id": "vxkJwuCfNewJ"
   },
   "outputs": [],
   "source": [
    "df = df.drop(['iid', 'id', 'idg', 'pid'], axis = 1) # Useless"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "id": "i2q1dNMZ0Zg5"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>?</th>\n",
       "      <th>\" \"</th>\n",
       "      <th>NaN</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>gender</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>condtn</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wave</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>round</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>position</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr5_3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc5_3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel5_3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun5_3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb5_3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6362</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>191 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          ?  \" \"   NaN\n",
       "gender    0    0     0\n",
       "condtn    0    0     0\n",
       "wave      0    0     0\n",
       "round     0    0     0\n",
       "position  0    0     0\n",
       "...      ..  ...   ...\n",
       "attr5_3   0    0  6362\n",
       "sinc5_3   0    0  6362\n",
       "intel5_3  0    0  6362\n",
       "fun5_3    0    0  6362\n",
       "amb5_3    0    0  6362\n",
       "\n",
       "[191 rows x 3 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Count \"?\", les \" \" and \"NaN\" in a df\n",
    "def count_sym_df(df):\n",
    "    cols = df.columns\n",
    "    sym1 = ['?']\n",
    "    sym2 = ['\" \"']\n",
    "    sym3 = [np.NaN]\n",
    "    counting_interro = {}\n",
    "    counting_space = {}\n",
    "    counting_NaN = {}\n",
    "\n",
    "    for j in sym1:\n",
    "        for i in cols:\n",
    "            c = df.loc[:,i][df.loc[:,i] == j].count()\n",
    "            counting_interro[i] = c     \n",
    "\n",
    "    for j in sym2:\n",
    "        for i in cols:\n",
    "            c = df.loc[:,i][df.loc[:,i] == j].count()\n",
    "            counting_space[i] = c\n",
    "\n",
    "    for j in sym3:\n",
    "        for i in cols:\n",
    "            c = df.loc[:,i].isna().sum()\n",
    "            counting_NaN[i] = c\n",
    "\n",
    "    df_sym = pd.DataFrame({'?': counting_interro, '\" \"': counting_space, 'NaN': counting_NaN})\n",
    "    return df_sym\n",
    "\n",
    "count_sym_df(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "id": "9AO6m3X80Zg6"
   },
   "outputs": [],
   "source": [
    "obj_data=[]\n",
    "num_data=[]\n",
    "\n",
    "for i, c in enumerate(df.dtypes):\n",
    "    if c == object:\n",
    "        obj_data.append(df.iloc[:,i])\n",
    "    else:\n",
    "        num_data.append(df.iloc[:,i])\n",
    "\n",
    "obj_data=pd.DataFrame(obj_data).transpose()\n",
    "num_data=pd.DataFrame(num_data).transpose()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "F-B6dXIG0Zg7",
    "outputId": "96e16aab-e977-4de7-c6f0-5bfa8039b143"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       0.0\n",
       "1       0.0\n",
       "2       1.0\n",
       "3       1.0\n",
       "4       1.0\n",
       "       ... \n",
       "8373    0.0\n",
       "8374    0.0\n",
       "8375    0.0\n",
       "8376    0.0\n",
       "8377    0.0\n",
       "Name: match, Length: 8378, dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "target = num_data['match']\n",
    "target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 419
    },
    "id": "tiCFa2JH0Zg8",
    "outputId": "5e70148f-0f01-4315-d01a-04c9eddbf4f4"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>field</th>\n",
       "      <th>undergra</th>\n",
       "      <th>mn_sat</th>\n",
       "      <th>tuition</th>\n",
       "      <th>from</th>\n",
       "      <th>zipcode</th>\n",
       "      <th>income</th>\n",
       "      <th>career</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Law</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60,521</td>\n",
       "      <td>69,487.00</td>\n",
       "      <td>lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Law</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60,521</td>\n",
       "      <td>69,487.00</td>\n",
       "      <td>lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Law</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60,521</td>\n",
       "      <td>69,487.00</td>\n",
       "      <td>lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Law</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60,521</td>\n",
       "      <td>69,487.00</td>\n",
       "      <td>lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Law</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60,521</td>\n",
       "      <td>69,487.00</td>\n",
       "      <td>lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8373</th>\n",
       "      <td>Climate Dynamics</td>\n",
       "      <td>Ecole Normale Suprieure, Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>France</td>\n",
       "      <td>78,110</td>\n",
       "      <td>NaN</td>\n",
       "      <td>assistant master of the universe (otherwise it...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8374</th>\n",
       "      <td>Climate Dynamics</td>\n",
       "      <td>Ecole Normale Suprieure, Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>France</td>\n",
       "      <td>78,110</td>\n",
       "      <td>NaN</td>\n",
       "      <td>assistant master of the universe (otherwise it...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8375</th>\n",
       "      <td>Climate Dynamics</td>\n",
       "      <td>Ecole Normale Suprieure, Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>France</td>\n",
       "      <td>78,110</td>\n",
       "      <td>NaN</td>\n",
       "      <td>assistant master of the universe (otherwise it...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8376</th>\n",
       "      <td>Climate Dynamics</td>\n",
       "      <td>Ecole Normale Suprieure, Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>France</td>\n",
       "      <td>78,110</td>\n",
       "      <td>NaN</td>\n",
       "      <td>assistant master of the universe (otherwise it...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8377</th>\n",
       "      <td>Climate Dynamics</td>\n",
       "      <td>Ecole Normale Suprieure, Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>France</td>\n",
       "      <td>78,110</td>\n",
       "      <td>NaN</td>\n",
       "      <td>assistant master of the universe (otherwise it...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8378 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 field                         undergra mn_sat tuition  \\\n",
       "0                  Law                              NaN    NaN     NaN   \n",
       "1                  Law                              NaN    NaN     NaN   \n",
       "2                  Law                              NaN    NaN     NaN   \n",
       "3                  Law                              NaN    NaN     NaN   \n",
       "4                  Law                              NaN    NaN     NaN   \n",
       "...                ...                              ...    ...     ...   \n",
       "8373  Climate Dynamics  Ecole Normale Suprieure, Paris    NaN     NaN   \n",
       "8374  Climate Dynamics  Ecole Normale Suprieure, Paris    NaN     NaN   \n",
       "8375  Climate Dynamics  Ecole Normale Suprieure, Paris    NaN     NaN   \n",
       "8376  Climate Dynamics  Ecole Normale Suprieure, Paris    NaN     NaN   \n",
       "8377  Climate Dynamics  Ecole Normale Suprieure, Paris    NaN     NaN   \n",
       "\n",
       "         from zipcode     income  \\\n",
       "0     Chicago  60,521  69,487.00   \n",
       "1     Chicago  60,521  69,487.00   \n",
       "2     Chicago  60,521  69,487.00   \n",
       "3     Chicago  60,521  69,487.00   \n",
       "4     Chicago  60,521  69,487.00   \n",
       "...       ...     ...        ...   \n",
       "8373   France  78,110        NaN   \n",
       "8374   France  78,110        NaN   \n",
       "8375   France  78,110        NaN   \n",
       "8376   France  78,110        NaN   \n",
       "8377   France  78,110        NaN   \n",
       "\n",
       "                                                 career  \n",
       "0                                                lawyer  \n",
       "1                                                lawyer  \n",
       "2                                                lawyer  \n",
       "3                                                lawyer  \n",
       "4                                                lawyer  \n",
       "...                                                 ...  \n",
       "8373  assistant master of the universe (otherwise it...  \n",
       "8374  assistant master of the universe (otherwise it...  \n",
       "8375  assistant master of the universe (otherwise it...  \n",
       "8376  assistant master of the universe (otherwise it...  \n",
       "8377  assistant master of the universe (otherwise it...  \n",
       "\n",
       "[8378 rows x 8 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obj_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "F4W2rnBp0Zg8",
    "outputId": "ab11384b-7010-4e4d-b018-160a8e36b43d"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender         0\n",
       "condtn         0\n",
       "wave           0\n",
       "round          0\n",
       "position       0\n",
       "            ... \n",
       "attr5_3     6362\n",
       "sinc5_3     6362\n",
       "intel5_3    6362\n",
       "fun5_3      6362\n",
       "amb5_3      6362\n",
       "Length: 183, dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_data.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 1000
    },
    "id": "cs0lpo730Zg8",
    "outputId": "90ffa582-dde6-4af1-92fb-eb47c537612d"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>percent_missing</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>gender</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>condtn</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wave</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>round</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>position</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>positin1</th>\n",
       "      <td>22.033898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>order</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>partner</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>match</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>int_corr</th>\n",
       "      <td>1.885892</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>samerace</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>age_o</th>\n",
       "      <td>1.241346</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>race_o</th>\n",
       "      <td>0.871330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_att</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_sin</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_int</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_fun</th>\n",
       "      <td>1.169730</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_amb</th>\n",
       "      <td>1.277154</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pf_o_sha</th>\n",
       "      <td>1.539747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>dec_o</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr_o</th>\n",
       "      <td>2.530437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc_o</th>\n",
       "      <td>3.425639</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel_o</th>\n",
       "      <td>3.652423</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun_o</th>\n",
       "      <td>4.296968</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb_o</th>\n",
       "      <td>8.617809</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar_o</th>\n",
       "      <td>12.843161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>like_o</th>\n",
       "      <td>2.984006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>prob_o</th>\n",
       "      <td>3.795655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>met_o</th>\n",
       "      <td>4.595369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>age</th>\n",
       "      <td>1.133922</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>field_cd</th>\n",
       "      <td>0.978754</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>race</th>\n",
       "      <td>0.751969</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>imprace</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>imprelig</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>goal</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date</th>\n",
       "      <td>1.157794</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>go_out</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>career_c</th>\n",
       "      <td>1.647171</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sports</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tvsports</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>exercise</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>dining</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>museums</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>art</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>hiking</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>gaming</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>clubbing</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>reading</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tv</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>theater</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>movies</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>concerts</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>music</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shopping</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>yoga</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>exphappy</th>\n",
       "      <td>1.205538</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>expnum</th>\n",
       "      <td>78.515159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr1_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc1_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel1_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun1_1</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb1_1</th>\n",
       "      <td>1.181666</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar1_1</th>\n",
       "      <td>1.444259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr4_1</th>\n",
       "      <td>22.547147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc4_1</th>\n",
       "      <td>22.547147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel4_1</th>\n",
       "      <td>22.547147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun4_1</th>\n",
       "      <td>22.547147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb4_1</th>\n",
       "      <td>22.547147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar4_1</th>\n",
       "      <td>22.809740</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr2_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc2_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel2_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun2_1</th>\n",
       "      <td>0.942946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb2_1</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar2_1</th>\n",
       "      <td>1.062306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr3_1</th>\n",
       "      <td>1.253282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc3_1</th>\n",
       "      <td>1.253282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun3_1</th>\n",
       "      <td>1.253282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel3_1</th>\n",
       "      <td>1.253282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb3_1</th>\n",
       "      <td>1.253282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr5_1</th>\n",
       "      <td>41.441872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc5_1</th>\n",
       "      <td>41.441872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel5_1</th>\n",
       "      <td>41.441872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun5_1</th>\n",
       "      <td>41.441872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb5_1</th>\n",
       "      <td>41.441872</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>dec</th>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr</th>\n",
       "      <td>2.411077</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc</th>\n",
       "      <td>3.306278</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel</th>\n",
       "      <td>3.533063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun</th>\n",
       "      <td>4.177608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb</th>\n",
       "      <td>8.498448</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar</th>\n",
       "      <td>12.735736</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>like</th>\n",
       "      <td>2.864646</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>prob</th>\n",
       "      <td>3.688231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>met</th>\n",
       "      <td>4.476009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>match_es</th>\n",
       "      <td>14.000955</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar1_s</th>\n",
       "      <td>51.110050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr3_s</th>\n",
       "      <td>52.255908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc3_s</th>\n",
       "      <td>52.255908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel3_s</th>\n",
       "      <td>52.255908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun3_s</th>\n",
       "      <td>52.255908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb3_s</th>\n",
       "      <td>52.255908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>satis_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>length</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>numdat_2</th>\n",
       "      <td>11.279542</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr7_2</th>\n",
       "      <td>76.318931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc7_2</th>\n",
       "      <td>76.665075</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel7_2</th>\n",
       "      <td>76.318931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun7_2</th>\n",
       "      <td>76.318931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb7_2</th>\n",
       "      <td>76.665075</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar7_2</th>\n",
       "      <td>76.438291</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr1_2</th>\n",
       "      <td>11.136309</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc1_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel1_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun1_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb1_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar1_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar4_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar2_2</th>\n",
       "      <td>31.069468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr3_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc3_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel3_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun3_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb3_2</th>\n",
       "      <td>10.921461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr5_2</th>\n",
       "      <td>47.756028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc5_2</th>\n",
       "      <td>47.756028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel5_2</th>\n",
       "      <td>47.756028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun5_2</th>\n",
       "      <td>47.756028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb5_2</th>\n",
       "      <td>47.756028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>you_call</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>them_cal</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>numdat_3</th>\n",
       "      <td>82.143710</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>num_in_3</th>\n",
       "      <td>92.026737</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar1_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar7_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar4_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr2_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc2_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel2_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun2_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb2_3</th>\n",
       "      <td>64.681308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shar2_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr3_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc3_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel3_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun3_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb3_3</th>\n",
       "      <td>52.566245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>attr5_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sinc5_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>intel5_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fun5_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>amb5_3</th>\n",
       "      <td>75.936978</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          percent_missing\n",
       "gender           0.000000\n",
       "condtn           0.000000\n",
       "wave             0.000000\n",
       "round            0.000000\n",
       "position         0.000000\n",
       "positin1        22.033898\n",
       "order            0.000000\n",
       "partner          0.000000\n",
       "match            0.000000\n",
       "int_corr         1.885892\n",
       "samerace         0.000000\n",
       "age_o            1.241346\n",
       "race_o           0.871330\n",
       "pf_o_att         1.062306\n",
       "pf_o_sin         1.062306\n",
       "pf_o_int         1.062306\n",
       "pf_o_fun         1.169730\n",
       "pf_o_amb         1.277154\n",
       "pf_o_sha         1.539747\n",
       "dec_o            0.000000\n",
       "attr_o           2.530437\n",
       "sinc_o           3.425639\n",
       "intel_o          3.652423\n",
       "fun_o            4.296968\n",
       "amb_o            8.617809\n",
       "shar_o          12.843161\n",
       "like_o           2.984006\n",
       "prob_o           3.795655\n",
       "met_o            4.595369\n",
       "age              1.133922\n",
       "field_cd         0.978754\n",
       "race             0.751969\n",
       "imprace          0.942946\n",
       "imprelig         0.942946\n",
       "goal             0.942946\n",
       "date             1.157794\n",
       "go_out           0.942946\n",
       "career_c         1.647171\n",
       "sports           0.942946\n",
       "tvsports         0.942946\n",
       "exercise         0.942946\n",
       "dining           0.942946\n",
       "museums          0.942946\n",
       "art              0.942946\n",
       "hiking           0.942946\n",
       "gaming           0.942946\n",
       "clubbing         0.942946\n",
       "reading          0.942946\n",
       "tv               0.942946\n",
       "theater          0.942946\n",
       "movies           0.942946\n",
       "concerts         0.942946\n",
       "music            0.942946\n",
       "shopping         0.942946\n",
       "yoga             0.942946\n",
       "exphappy         1.205538\n",
       "expnum          78.515159\n",
       "attr1_1          0.942946\n",
       "sinc1_1          0.942946\n",
       "intel1_1         0.942946\n",
       "fun1_1           1.062306\n",
       "amb1_1           1.181666\n",
       "shar1_1          1.444259\n",
       "attr4_1         22.547147\n",
       "sinc4_1         22.547147\n",
       "intel4_1        22.547147\n",
       "fun4_1          22.547147\n",
       "amb4_1          22.547147\n",
       "shar4_1         22.809740\n",
       "attr2_1          0.942946\n",
       "sinc2_1          0.942946\n",
       "intel2_1         0.942946\n",
       "fun2_1           0.942946\n",
       "amb2_1           1.062306\n",
       "shar2_1          1.062306\n",
       "attr3_1          1.253282\n",
       "sinc3_1          1.253282\n",
       "fun3_1           1.253282\n",
       "intel3_1         1.253282\n",
       "amb3_1           1.253282\n",
       "attr5_1         41.441872\n",
       "sinc5_1         41.441872\n",
       "intel5_1        41.441872\n",
       "fun5_1          41.441872\n",
       "amb5_1          41.441872\n",
       "dec              0.000000\n",
       "attr             2.411077\n",
       "sinc             3.306278\n",
       "intel            3.533063\n",
       "fun              4.177608\n",
       "amb              8.498448\n",
       "shar            12.735736\n",
       "like             2.864646\n",
       "prob             3.688231\n",
       "met              4.476009\n",
       "match_es        14.000955\n",
       "attr1_s         51.110050\n",
       "sinc1_s         51.110050\n",
       "intel1_s        51.110050\n",
       "fun1_s          51.110050\n",
       "amb1_s          51.110050\n",
       "shar1_s         51.110050\n",
       "attr3_s         52.255908\n",
       "sinc3_s         52.255908\n",
       "intel3_s        52.255908\n",
       "fun3_s          52.255908\n",
       "amb3_s          52.255908\n",
       "satis_2         10.921461\n",
       "length          10.921461\n",
       "numdat_2        11.279542\n",
       "attr7_2         76.318931\n",
       "sinc7_2         76.665075\n",
       "intel7_2        76.318931\n",
       "fun7_2          76.318931\n",
       "amb7_2          76.665075\n",
       "shar7_2         76.438291\n",
       "attr1_2         11.136309\n",
       "sinc1_2         10.921461\n",
       "intel1_2        10.921461\n",
       "fun1_2          10.921461\n",
       "amb1_2          10.921461\n",
       "shar1_2         10.921461\n",
       "attr4_2         31.069468\n",
       "sinc4_2         31.069468\n",
       "intel4_2        31.069468\n",
       "fun4_2          31.069468\n",
       "amb4_2          31.069468\n",
       "shar4_2         31.069468\n",
       "attr2_2         31.069468\n",
       "sinc2_2         31.069468\n",
       "intel2_2        31.069468\n",
       "fun2_2          31.069468\n",
       "amb2_2          31.069468\n",
       "shar2_2         31.069468\n",
       "attr3_2         10.921461\n",
       "sinc3_2         10.921461\n",
       "intel3_2        10.921461\n",
       "fun3_2          10.921461\n",
       "amb3_2          10.921461\n",
       "attr5_2         47.756028\n",
       "sinc5_2         47.756028\n",
       "intel5_2        47.756028\n",
       "fun5_2          47.756028\n",
       "amb5_2          47.756028\n",
       "you_call        52.566245\n",
       "them_cal        52.566245\n",
       "date_3          52.566245\n",
       "numdat_3        82.143710\n",
       "num_in_3        92.026737\n",
       "attr1_3         52.566245\n",
       "sinc1_3         52.566245\n",
       "intel1_3        52.566245\n",
       "fun1_3          52.566245\n",
       "amb1_3          52.566245\n",
       "shar1_3         52.566245\n",
       "attr7_3         75.936978\n",
       "sinc7_3         75.936978\n",
       "intel7_3        75.936978\n",
       "fun7_3          75.936978\n",
       "amb7_3          75.936978\n",
       "shar7_3         75.936978\n",
       "attr4_3         64.681308\n",
       "sinc4_3         64.681308\n",
       "intel4_3        64.681308\n",
       "fun4_3          64.681308\n",
       "amb4_3          64.681308\n",
       "shar4_3         64.681308\n",
       "attr2_3         64.681308\n",
       "sinc2_3         64.681308\n",
       "intel2_3        64.681308\n",
       "fun2_3          64.681308\n",
       "amb2_3          64.681308\n",
       "shar2_3         75.936978\n",
       "attr3_3         52.566245\n",
       "sinc3_3         52.566245\n",
       "intel3_3        52.566245\n",
       "fun3_3          52.566245\n",
       "amb3_3          52.566245\n",
       "attr5_3         75.936978\n",
       "sinc5_3         75.936978\n",
       "intel5_3        75.936978\n",
       "fun5_3          75.936978\n",
       "amb5_3          75.936978"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Count NaN by columns\n",
    "pd.set_option('display.max_rows', num_data.shape[0])\n",
    "\n",
    "def percent_missing(df):\n",
    "    percent_missing = df.isnull().sum() * 100 / len(df)\n",
    "    missing_value_df = pd.DataFrame({'percent_missing': percent_missing})\n",
    "    return missing_value_df\n",
    "\n",
    "miss_val = percent_missing(num_data)\n",
    "miss_val"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "id": "KOqxh_LA0Zg9"
   },
   "outputs": [],
   "source": [
    "# Recovery of columns that have a percentage of missing values greater than 10 percent and delete them\n",
    "index_miss_val = miss_val[miss_val['percent_missing'] > 10].index.tolist()\n",
    "num_data = num_data.drop(index_miss_val, axis = 1) \n",
    "num_data = num_data.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "id": "8vtTQa5uVzeZ"
   },
   "outputs": [],
   "source": [
    "# Convert numerical and categorical\n",
    "numerical_var = [\"int_corr\", \"age_o\", \"pf_o_att\", \"pf_o_sin\", \"pf_o_int\", \"pf_o_fun\", \"pf_o_amb\", \"pf_o_sha\", \"age\", \"attr1_1\", \"attr1_1\", \"sinc1_1\", \"intel1_1\", \"fun1_1\", \"amb1_1\", \"shar1_1\", \"attr2_1\", \"sinc2_1\", \"intel2_1\", \"fun2_1\", \"amb2_1\", \"shar2_1\", \"attr3_1\", \"sinc3_1\", \"fun3_1\", \"intel3_1\", \"amb3_1\"]\n",
    "for v in num_data.columns: \n",
    "    num_data[v] = num_data[v].astype('category')\n",
    "for v in numerical_var:\n",
    "    num_data[v] = pd.to_numeric(num_data[v])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "5VPNtGCedLNh",
    "outputId": "2425bd45-fe86-41b1-de2c-570ebd64e9b8"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 6194 entries, 30 to 8377\n",
      "Data columns (total 80 columns):\n",
      " #   Column    Non-Null Count  Dtype   \n",
      "---  ------    --------------  -----   \n",
      " 0   gender    6194 non-null   category\n",
      " 1   condtn    6194 non-null   category\n",
      " 2   wave      6194 non-null   category\n",
      " 3   round     6194 non-null   category\n",
      " 4   position  6194 non-null   category\n",
      " 5   order     6194 non-null   category\n",
      " 6   partner   6194 non-null   category\n",
      " 7   match     6194 non-null   category\n",
      " 8   int_corr  6194 non-null   float64 \n",
      " 9   samerace  6194 non-null   category\n",
      " 10  age_o     6194 non-null   float64 \n",
      " 11  race_o    6194 non-null   category\n",
      " 12  pf_o_att  6194 non-null   float64 \n",
      " 13  pf_o_sin  6194 non-null   float64 \n",
      " 14  pf_o_int  6194 non-null   float64 \n",
      " 15  pf_o_fun  6194 non-null   float64 \n",
      " 16  pf_o_amb  6194 non-null   float64 \n",
      " 17  pf_o_sha  6194 non-null   float64 \n",
      " 18  dec_o     6194 non-null   category\n",
      " 19  attr_o    6194 non-null   category\n",
      " 20  sinc_o    6194 non-null   category\n",
      " 21  intel_o   6194 non-null   category\n",
      " 22  fun_o     6194 non-null   category\n",
      " 23  amb_o     6194 non-null   category\n",
      " 24  like_o    6194 non-null   category\n",
      " 25  prob_o    6194 non-null   category\n",
      " 26  met_o     6194 non-null   category\n",
      " 27  age       6194 non-null   float64 \n",
      " 28  field_cd  6194 non-null   category\n",
      " 29  race      6194 non-null   category\n",
      " 30  imprace   6194 non-null   category\n",
      " 31  imprelig  6194 non-null   category\n",
      " 32  goal      6194 non-null   category\n",
      " 33  date      6194 non-null   category\n",
      " 34  go_out    6194 non-null   category\n",
      " 35  career_c  6194 non-null   category\n",
      " 36  sports    6194 non-null   category\n",
      " 37  tvsports  6194 non-null   category\n",
      " 38  exercise  6194 non-null   category\n",
      " 39  dining    6194 non-null   category\n",
      " 40  museums   6194 non-null   category\n",
      " 41  art       6194 non-null   category\n",
      " 42  hiking    6194 non-null   category\n",
      " 43  gaming    6194 non-null   category\n",
      " 44  clubbing  6194 non-null   category\n",
      " 45  reading   6194 non-null   category\n",
      " 46  tv        6194 non-null   category\n",
      " 47  theater   6194 non-null   category\n",
      " 48  movies    6194 non-null   category\n",
      " 49  concerts  6194 non-null   category\n",
      " 50  music     6194 non-null   category\n",
      " 51  shopping  6194 non-null   category\n",
      " 52  yoga      6194 non-null   category\n",
      " 53  exphappy  6194 non-null   category\n",
      " 54  attr1_1   6194 non-null   float64 \n",
      " 55  sinc1_1   6194 non-null   float64 \n",
      " 56  intel1_1  6194 non-null   float64 \n",
      " 57  fun1_1    6194 non-null   float64 \n",
      " 58  amb1_1    6194 non-null   float64 \n",
      " 59  shar1_1   6194 non-null   float64 \n",
      " 60  attr2_1   6194 non-null   float64 \n",
      " 61  sinc2_1   6194 non-null   float64 \n",
      " 62  intel2_1  6194 non-null   float64 \n",
      " 63  fun2_1    6194 non-null   float64 \n",
      " 64  amb2_1    6194 non-null   float64 \n",
      " 65  shar2_1   6194 non-null   float64 \n",
      " 66  attr3_1   6194 non-null   float64 \n",
      " 67  sinc3_1   6194 non-null   float64 \n",
      " 68  fun3_1    6194 non-null   float64 \n",
      " 69  intel3_1  6194 non-null   float64 \n",
      " 70  amb3_1    6194 non-null   float64 \n",
      " 71  dec       6194 non-null   category\n",
      " 72  attr      6194 non-null   category\n",
      " 73  sinc      6194 non-null   category\n",
      " 74  intel     6194 non-null   category\n",
      " 75  fun       6194 non-null   category\n",
      " 76  amb       6194 non-null   category\n",
      " 77  like      6194 non-null   category\n",
      " 78  prob      6194 non-null   category\n",
      " 79  met       6194 non-null   category\n",
      "dtypes: category(54), float64(26)\n",
      "memory usage: 1.6 MB\n"
     ]
    }
   ],
   "source": [
    "num_data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "FtZENGB70Zg-",
    "outputId": "eca86a7d-b457-429d-daea-442f10730166"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(150, 80)\n",
      "(150, 80)\n"
     ]
    }
   ],
   "source": [
    "# Sub-sampling of class 0\n",
    "num_data_match0 = num_data.loc[num_data.match == 0,:].sample(150)\n",
    "print(num_data_match0.shape)\n",
    "num_data_match1 = num_data.loc[num_data.match == 1,:].sample(150)\n",
    "print(num_data_match1.shape)\n",
    "\n",
    "num_data = num_data_match0.append(num_data_match1)\n",
    "num_data.reset_index(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "EpvyIHlP0Zg-",
    "outputId": "7b873d9d-8611-401f-f63b-e5df7981d540"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(300, 79)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "target = num_data['match']\n",
    "num_data = num_data.drop(['match', 'index'], axis = 1) \n",
    "num_data.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "AqDAGbW90Zg-",
    "outputId": "8141b5c0-5817-4e85-c576-008c9889b0cb"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(300, 79)\n",
      "(300,)\n"
     ]
    }
   ],
   "source": [
    "X = num_data\n",
    "y = target\n",
    "print(X.shape)\n",
    "print(y.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "lPSChmpt0Zg-"
   },
   "source": [
    "# Modelisation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "KPkLaOsO0Zg_"
   },
   "source": [
    "## Train/Test Shuffled Split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "dTM88H7Y0Zg_",
    "outputId": "993915b8-9956-4199-986b-d9de99b780d2"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X_train shape : (240, 79)\n",
      "y_train shape : (240,)\n",
      "X_test shape : (60, 79)\n",
      "y_test shape : (60,)\n"
     ]
    }
   ],
   "source": [
    "sss = StratifiedShuffleSplit(n_splits=10, test_size=0.2, random_state=777)\n",
    "\n",
    "for train, test in sss.split(X, y):\n",
    "    X_train, X_test = X.iloc[train], X.iloc[test]\n",
    "    y_train, y_test = y.iloc[train], y.iloc[test]\n",
    "\n",
    "print('X_train shape :', X_train.shape)\n",
    "print('y_train shape :', y_train.shape)\n",
    "print('X_test shape :', X_test.shape)\n",
    "print('y_test shape :', y_test.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "srvw6G_C0Zg_",
    "outputId": "c9af2dc1-833c-4b1c-e6c3-a61e2273e87b"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Répartition des classes de y_train :\n",
      "col_0  count\n",
      "match       \n",
      "0.0      120\n",
      "1.0      120\n",
      " \n",
      "Répartition des classes de y_test :\n",
      "col_0  count\n",
      "match       \n",
      "0.0       30\n",
      "1.0       30\n"
     ]
    }
   ],
   "source": [
    "# Comptage de la répartition des classes de la variable 'match'\n",
    "print('Répartition des classes de y_train :')\n",
    "print(pd.crosstab(index=y_train,columns=\"count\"))\n",
    "print(\" \")\n",
    "print('Répartition des classes de y_test :')\n",
    "print(pd.crosstab(index=y_test,columns=\"count\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "zG65IfCC0Zg_"
   },
   "source": [
    "## Fitting some Models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "id": "-OVqGroi0Zg_"
   },
   "outputs": [],
   "source": [
    "models = {\n",
    "    'SVC': SVC(),\n",
    "    'LogisticRegression': LogisticRegression(),\n",
    "    'DecisionTreeClassifier': DecisionTreeClassifier(),\n",
    "    'RandomForest': RandomForestClassifier()\n",
    "} "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "id": "wTADxtPh0ZhA"
   },
   "outputs": [],
   "source": [
    "def train_test_eval(models, X_train, y_train, X_test, y_test, curve_fold=0, lcurve = False):\n",
    "    test_results = []\n",
    "    \n",
    "    for name, model in models.items():\n",
    "        print('     Model \"{}\"'.format(name))\n",
    "        # Fitting model\n",
    "        model.fit(X_train, y_train)\n",
    "        acc = accuracy_score(y_test, model.predict(X_test))\n",
    "        pre = precision_score(y_test, model.predict(X_test))\n",
    "        rec = recall_score(y_test, model.predict(X_test))\n",
    "        f_1 = f1_score(y_test, model.predict(X_test))\n",
    "        test_results.append([name, round(acc*100, 2), round(pre*100, 2), round(rec*100, 2), round(f_1*100, 2)])\n",
    "\n",
    "        # Classification report\n",
    "        print(\" \")\n",
    "        print(\"Classification report :\")\n",
    "        print(\" \")\n",
    "        clf_report = classification_report(y_test, model.predict(X_test))\n",
    "        print(clf_report)\n",
    "\n",
    "    # Learning curves\n",
    "    if lcurve == True:\n",
    "        print('Learning curve of \"{}\" model (F1 score) :'.format(name))\n",
    "        plt.figure(figsize=(8,4))\n",
    "        N, train_score, val_score = learning_curve(model, X_train, y_train, cv = curve_fold, scoring = 'f1', train_sizes=np.linspace(0.1, 1, 10))\n",
    "        plt.plot(N, train_score.mean(axis=1), label = \"train score\")\n",
    "        plt.plot(N, val_score.mean(axis=1), label = \"validation score\")\n",
    "        plt.legend()\n",
    "        plt.show()\n",
    "\n",
    "    print(\" \")\n",
    "    print(\"=\"*65)\n",
    "    print(\" \")\n",
    "    print(\" \")\n",
    "\n",
    "    test_results = pd.DataFrame(test_results, columns = ['model', 'accuracy', 'precision', 'recall', 'f1'])\n",
    "    print(\"Results :\")\n",
    "    return test_results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 1000
    },
    "id": "_sDyNl1F0ZhA",
    "outputId": "ab127b0f-ab2f-4c56-9743-77da7941b18c"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Model \"SVC\"\n",
      " \n",
      "Classification report :\n",
      " \n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "         0.0       0.73      0.53      0.62        30\n",
      "         1.0       0.63      0.80      0.71        30\n",
      "\n",
      "    accuracy                           0.67        60\n",
      "   macro avg       0.68      0.67      0.66        60\n",
      "weighted avg       0.68      0.67      0.66        60\n",
      "\n",
      "     Model \"LogisticRegression\"\n",
      " \n",
      "Classification report :\n",
      " \n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "         0.0       0.88      0.77      0.82        30\n",
      "         1.0       0.79      0.90      0.84        30\n",
      "\n",
      "    accuracy                           0.83        60\n",
      "   macro avg       0.84      0.83      0.83        60\n",
      "weighted avg       0.84      0.83      0.83        60\n",
      "\n",
      "     Model \"DecisionTreeClassifier\"\n",
      " \n",
      "Classification report :\n",
      " \n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "         0.0       1.00      1.00      1.00        30\n",
      "         1.0       1.00      1.00      1.00        30\n",
      "\n",
      "    accuracy                           1.00        60\n",
      "   macro avg       1.00      1.00      1.00        60\n",
      "weighted avg       1.00      1.00      1.00        60\n",
      "\n",
      "     Model \"RandomForest\"\n",
      " \n",
      "Classification report :\n",
      " \n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "         0.0       0.97      1.00      0.98        30\n",
      "         1.0       1.00      0.97      0.98        30\n",
      "\n",
      "    accuracy                           0.98        60\n",
      "   macro avg       0.98      0.98      0.98        60\n",
      "weighted avg       0.98      0.98      0.98        60\n",
      "\n",
      " \n",
      "=================================================================\n",
      " \n",
      " \n",
      "Results :\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>model</th>\n",
       "      <th>accuracy</th>\n",
       "      <th>precision</th>\n",
       "      <th>recall</th>\n",
       "      <th>f1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>SVC</td>\n",
       "      <td>66.67</td>\n",
       "      <td>63.16</td>\n",
       "      <td>80.00</td>\n",
       "      <td>70.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>LogisticRegression</td>\n",
       "      <td>83.33</td>\n",
       "      <td>79.41</td>\n",
       "      <td>90.00</td>\n",
       "      <td>84.38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DecisionTreeClassifier</td>\n",
       "      <td>100.00</td>\n",
       "      <td>100.00</td>\n",
       "      <td>100.00</td>\n",
       "      <td>100.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>RandomForest</td>\n",
       "      <td>98.33</td>\n",
       "      <td>100.00</td>\n",
       "      <td>96.67</td>\n",
       "      <td>98.31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    model  accuracy  precision  recall      f1\n",
       "0                     SVC     66.67      63.16   80.00   70.59\n",
       "1      LogisticRegression     83.33      79.41   90.00   84.38\n",
       "2  DecisionTreeClassifier    100.00     100.00  100.00  100.00\n",
       "3            RandomForest     98.33     100.00   96.67   98.31"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_test_eval(models, X_train, y_train, X_test, y_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "LR has the largest error rate overall. We will keep it for the rest of the experience, since the margin of improvment is the greatest. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 703
    },
    "id": "sBeRJ6v10ZhB",
    "outputId": "116e1a1c-7c03-4c1a-e33d-32f8b3bd440c"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Unexpected exception formatting exception. Falling back to standard exception\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Traceback (most recent call last):\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3442, in run_code\n",
      "    exec(code_obj, self.user_global_ns, self.user_ns)\n",
      "  File \"/var/folders/9_/vs_h9bj563s_95ccbd6yn7p80000gn/T/ipykernel_45539/4095579481.py\", line 1, in <module>\n",
      "    grid_results, best_params = gridcv_train_test_eval(models2, params_list, 5, X_train, y_train, X_test, y_test, metric='f1')\n",
      "NameError: name 'gridcv_train_test_eval' is not defined\n",
      "\n",
      "During handling of the above exception, another exception occurred:\n",
      "\n",
      "Traceback (most recent call last):\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 2057, in showtraceback\n",
      "    stb = self.InteractiveTB.structured_traceback(\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/ultratb.py\", line 1118, in structured_traceback\n",
      "    return FormattedTB.structured_traceback(\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/ultratb.py\", line 1012, in structured_traceback\n",
      "    return VerboseTB.structured_traceback(\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/ultratb.py\", line 865, in structured_traceback\n",
      "    formatted_exception = self.format_exception_as_a_whole(etype, evalue, etb, number_of_lines_of_context,\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/ultratb.py\", line 818, in format_exception_as_a_whole\n",
      "    frames.append(self.format_record(r))\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/IPython/core/ultratb.py\", line 736, in format_record\n",
      "    result += ''.join(_format_traceback_lines(frame_info.lines, Colors, self.has_colors, lvals))\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/utils.py\", line 144, in cached_property_wrapper\n",
      "    value = obj.__dict__[self.func.__name__] = self.func(obj)\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/core.py\", line 734, in lines\n",
      "    pieces = self.included_pieces\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/utils.py\", line 144, in cached_property_wrapper\n",
      "    value = obj.__dict__[self.func.__name__] = self.func(obj)\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/core.py\", line 677, in included_pieces\n",
      "    scope_pieces = self.scope_pieces\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/utils.py\", line 144, in cached_property_wrapper\n",
      "    value = obj.__dict__[self.func.__name__] = self.func(obj)\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/core.py\", line 614, in scope_pieces\n",
      "    scope_start, scope_end = self.source.line_range(self.scope)\n",
      "  File \"/Users/thierrybombard/miniconda3/envs/jupyter/lib/python3.10/site-packages/stack_data/core.py\", line 178, in line_range\n",
      "    return line_range(self.asttext(), node)\n",
      "AttributeError: 'Source' object has no attribute 'asttext'\n"
     ]
    }
   ],
   "source": [
    "grid_results, best_params = gridcv_train_test_eval(models2, params_list, 5, X_train, y_train, X_test, y_test, metric='f1')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "tZD9BTgQ-5NO",
    "outputId": "74fc8cbe-2e96-4339-8df5-b602ddbebc0b"
   },
   "outputs": [],
   "source": [
    "best_params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "0mOWoBIQ0ZhC"
   },
   "source": [
    "# Performance of the selected model with subsets of random attribute combinations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 419
    },
    "id": "C3APymAZ0ZhC",
    "outputId": "376914f6-2765-42cb-c95f-5d9392efddd4"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>columns</th>\n",
       "      <th>performance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[31, 35, 64, 1, 16, 25, 71, 44, 3, 24, 60, 56,...</td>\n",
       "      <td>0.758364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>[33, 70, 76, 69, 7, 72, 36, 54, 22, 65, 1, 58,...</td>\n",
       "      <td>0.737218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>[77, 7, 19, 23, 26, 14, 45, 70, 32, 34, 68, 74...</td>\n",
       "      <td>0.727774</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>[70, 30, 57, 23, 76, 37, 38, 26, 27, 73, 7, 65...</td>\n",
       "      <td>0.723926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>[1, 2, 35, 63, 31, 24, 5, 22, 42, 46, 58, 16, ...</td>\n",
       "      <td>0.722468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94</th>\n",
       "      <td>[34, 26, 19, 40, 8, 38, 37, 53, 57, 65, 58, 36...</td>\n",
       "      <td>0.498114</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>[15, 59, 56, 46, 27, 4, 31, 3]</td>\n",
       "      <td>0.495851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>[29, 11, 14, 38]</td>\n",
       "      <td>0.488994</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>[69, 10, 3, 5, 45]</td>\n",
       "      <td>0.419302</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>[25, 14, 58, 45, 50, 31]</td>\n",
       "      <td>0.407348</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>99 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              columns  performance\n",
       "0   [31, 35, 64, 1, 16, 25, 71, 44, 3, 24, 60, 56,...     0.758364\n",
       "1   [33, 70, 76, 69, 7, 72, 36, 54, 22, 65, 1, 58,...     0.737218\n",
       "2   [77, 7, 19, 23, 26, 14, 45, 70, 32, 34, 68, 74...     0.727774\n",
       "3   [70, 30, 57, 23, 76, 37, 38, 26, 27, 73, 7, 65...     0.723926\n",
       "4   [1, 2, 35, 63, 31, 24, 5, 22, 42, 46, 58, 16, ...     0.722468\n",
       "..                                                ...          ...\n",
       "94  [34, 26, 19, 40, 8, 38, 37, 53, 57, 65, 58, 36...     0.498114\n",
       "95                     [15, 59, 56, 46, 27, 4, 31, 3]     0.495851\n",
       "96                                   [29, 11, 14, 38]     0.488994\n",
       "97                                 [69, 10, 3, 5, 45]     0.419302\n",
       "98                           [25, 14, 58, 45, 50, 31]     0.407348\n",
       "\n",
       "[99 rows x 2 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.reset_option('display.max_rows')\n",
    "model_test = SVC()\n",
    "result = []\n",
    "\n",
    "for i in range(100):\n",
    "    N_columns =  np.random.choice(range(X_train.shape[1]),1)\n",
    "    if N_columns != [0]:        \n",
    "        attributes_max_range = range(X_train.shape[1])\n",
    "        columns = np.random.choice(attributes_max_range, size=N_columns, replace=False).tolist()\n",
    "        scores = cross_val_score(model_test, X_train.iloc[:,columns], y_train, cv=10, scoring=\"f1\", error_score='raise')\n",
    "        result.append({'columns':columns,'performance':np.mean(scores)})\n",
    "\n",
    "result.sort(key=lambda x : -x['performance'])\n",
    "result_df = pd.DataFrame(result, columns = [\"columns\", \"performance\"])\n",
    "result_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "UkxQn8Cjgeva"
   },
   "source": [
    "With this model, there is a combination of attributes that allows to have better performances than before. The selected columns are:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 419
    },
    "id": "XrYjqJwG0ZhD",
    "outputId": "4cdc7a4b-f612-43c2-c45b-2b4381189490"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['goal', 'sports', 'shar2_1', 'condtn', 'pf_o_sha', 'met_o', 'attr',\n",
       "       'reading', 'round', 'prob_o', 'sinc2_1', 'fun1_1', 'exercise', 'dec',\n",
       "       'intel1_1', 'age_o', 'music', 'movies', 'art', 'amb2_1', 'amb_o',\n",
       "       'pf_o_fun', 'like', 'pf_o_int', 'intel_o', 'amb', 'dec_o', 'sinc',\n",
       "       'date', 'concerts', 'pf_o_sin', 'yoga', 'museums', 'met', 'fun_o',\n",
       "       'amb3_1', 'gaming', 'imprelig', 'dining', 'like_o', 'imprace',\n",
       "       'samerace', 'sinc3_1'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.iloc[:,result_df.loc[0,'columns']].columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "8rCA3Mq50ZhD"
   },
   "source": [
    "# Genetic Algorithm Implementation for Feature Selection"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "yIQ3Rue70ZhD"
   },
   "source": [
    "## Population"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "id": "qnTMVksU0ZhE"
   },
   "outputs": [],
   "source": [
    "attributs = X.columns.values\n",
    "\n",
    "def generation_population(attributs, taille=10):\n",
    "    population = {}\n",
    "    for i in range(taille):\n",
    "        individu = np.random.randint(2, size = len(attributs))\n",
    "        population['individu_{}'.format(i)] = individu\n",
    "    return population"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "B2AGLUAF0ZhE"
   },
   "source": [
    "## Reproduction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "id": "zQEvd0xQ0ZhE"
   },
   "outputs": [],
   "source": [
    "def reproduction(population):\n",
    "    # Couple association\n",
    "    l = [x for x in range(10)]\n",
    "    random.shuffle(l)\n",
    "    couples = []\n",
    "\n",
    "    for i in range(len(population) // 2):\n",
    "        couples.append([population['individu_{}'.format(l[2 * i])], population['individu_{}'.format(l[2 * i + 1])]])\n",
    "  \n",
    "    # Child\n",
    "    enfants = list()\n",
    "    for j in range(len(couples)):\n",
    "        cut = np.random.randint(1,len(population['individu_{}'.format(j)]-1))\n",
    "        enfant_j = np.concatenate((couples[j][0][:cut], couples[j][1][cut:]))\n",
    "        enfants.append(enfant_j)\n",
    "  \n",
    "  # Adding child to our population\n",
    "    for k in range(len(enfants)):\n",
    "        population['individu_{}'.format(len(population))] = enfants[k]\n",
    "    return population"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "YvUHXqSl0ZhE"
   },
   "source": [
    "## Mutation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "id": "GcJbveuQ0ZhE"
   },
   "outputs": [],
   "source": [
    "def mutation(population, nb_individus_mutants, nb_mutations):\n",
    "  # Extraction of random genomes (individuals) that will be subsequently mutated\n",
    "    for i in range(nb_individus_mutants):\n",
    "        alpha = np.random.randint(0,len(population) - 1)\n",
    "        genome = population['individu_{}'.format(alpha)].copy()\n",
    "\n",
    "    # Selection of a gene from the genome and number of mutations (gene change)\n",
    "    for j in range(nb_mutations):\n",
    "        gene = np.random.randint(1, len(genome) - 1)\n",
    "        if genome[gene] == 0:\n",
    "            genome[gene] == 1\n",
    "        else:\n",
    "            genome[gene] == 0\n",
    "    population['individu_{}'.format(len(population))] = genome\n",
    "    return population"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "RqSO1WqO0ZhG"
   },
   "source": [
    "## Selection of the best individuals and new generations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "id": "FTGl-UYF0ZhG"
   },
   "outputs": [],
   "source": [
    "def selection(population, attributs, model, X, y, metric='accuracy', n_fold=10):\n",
    "    results = []\n",
    "\n",
    "    for i in range(len(population)):\n",
    "        # Splitting our dataset as train/test\n",
    "        kf = KFold(n_splits=n_fold)\n",
    "        kf.get_n_splits(X)\n",
    "\n",
    "        for train, test in kf.split(X, y):\n",
    "            X_train, X_test = X.iloc[train], X.iloc[test]\n",
    "            y_train, y_test = y.iloc[train], y.iloc[test]\n",
    "\n",
    "        # Genomes and gene selection (attributes)\n",
    "        genome = population['individu_{}'.format(i)]\n",
    "        selected_genes = genome != 0\n",
    "        selected_col = attributs[selected_genes]\n",
    "\n",
    "        # Fitting and testing\n",
    "        fit_model = model.fit(X_train[selected_col], y_train)\n",
    "        y_predictions = model.predict(X_test[selected_col])\n",
    "\n",
    "        # Scores\n",
    "        acc = accuracy_score(y_test, y_predictions)\n",
    "        pre = precision_score(y_test, y_predictions)\n",
    "        rec = recall_score(y_test, y_predictions)\n",
    "        f_1 = f1_score(y_test, y_predictions)\n",
    "        results.append([i, round(acc*100, 2), round(pre*100, 2), round(rec*100, 2), round(f_1*100, 2)])\n",
    "\n",
    "    results_df = pd.DataFrame(results, columns = ['individu','accuracy', 'precision', 'recall', 'f1'])\n",
    "    total = results_df.loc[:,['individu',metric]].sort_values(metric, ascending = False)\n",
    "    ten_bests = total[:10]\n",
    "\n",
    "    # Population renew for each algorithm iteration\n",
    "    new_population = {}\n",
    "\n",
    "    for i, j in zip(range(len(ten_bests.index)), ten_bests.index):\n",
    "        new_population['individu_{}'.format(i)] = population['individu_{}'.format(j)].copy()\n",
    "  \n",
    "    best_individual = ten_bests.head(1)['individu'] # Le meilleur individu sera toujours celui qui est en première position dans le dataframe\n",
    "    best_attributs = population['individu_{}'.format(int(best_individual.values))]\n",
    "    return max(ten_bests.loc[:,metric]), best_individual, best_attributs, total, new_population"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "89syGB_w0ZhG"
   },
   "source": [
    "## Performance of individuals across generations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "id": "_OcukKoT8Arl"
   },
   "outputs": [],
   "source": [
    "n_generations = 300"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "id": "eMODnO1fjd8P"
   },
   "outputs": [],
   "source": [
    "model = SVC()\n",
    "population = generation_population(attributs, taille=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "7xkduHihi6RV",
    "outputId": "eb67230a-a48b-416d-cc6f-11832408aaf3",
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Score : 66.67 => individu 7\n",
      "Score : 66.67 => individu 0\n",
      "Score : 66.67 => individu 0\n",
      "Score : 72.34 => individu 12\n",
      "Score : 72.34 => individu 0\n",
      "Score : 72.34 => individu 0\n",
      "Score : 72.34 => individu 0\n",
      "Score : 72.34 => individu 0\n",
      "Score : 72.34 => individu 0\n",
      "Score : 72.34 => individu 0\n",
      "Score : 75.0 => individu 12\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 75.0 => individu 0\n",
      "Score : 77.55 => individu 11\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Score : 77.55 => individu 0\n",
      "Meilleur individu : 0 (= 0 si convergence) => score 77.55\n",
      "Avec les attributs suivants : ['wave' 'round' 'order' 'age_o' 'race_o' 'pf_o_amb' 'attr_o' 'sinc_o'\n",
      " 'intel_o' 'fun_o' 'amb_o' 'like_o' 'prob_o' 'imprace' 'career_c'\n",
      " 'exercise' 'dining' 'museums' 'hiking' 'gaming' 'reading' 'theater'\n",
      " 'concerts' 'exphappy' 'attr1_1' 'sinc1_1' 'intel1_1' 'shar1_1' 'attr2_1'\n",
      " 'shar2_1' 'intel3_1' 'sinc' 'intel' 'amb' 'like' 'prob' 'met']\n"
     ]
    }
   ],
   "source": [
    "y_ax = []\n",
    "\n",
    "for i in range(n_generations):\n",
    "    population = reproduction(population)\n",
    "    population = mutation(population, 5, 3)\n",
    "    best2, best_individual, best_attributs, total, population = selection(population, attributs, model, X, y, metric='f1')\n",
    "    y_ax.append(best2)\n",
    "    print(\"Score : {} => individu {}\".format(best2, int(best_individual.values)))\n",
    "\n",
    "best_attributes = attributs[best_attributs != 0]\n",
    "print(\"Meilleur individu : {} (= 0 si convergence) => score {}\".format(int(best_individual.values), best2))\n",
    "print(\"Avec les attributs suivants : {}\".format(best_attributes))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "WDSFFuqWJdim"
   },
   "source": [
    "## Score evolution across generations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 459
    },
    "id": "Bvm3tEKfB406",
    "outputId": "844ce780-b450-424c-d4e5-7b5577a7db5a"
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABDsAAAJaCAYAAAAhy0znAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjYuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8o6BhiAAAACXBIWXMAAA9hAAAPYQGoP6dpAABSR0lEQVR4nO3deZxVBd0/8M8AwzCsLohAAqKCC+57aqIpmJqamhuPK6aWW7gmLjVWuCaaYi5laCqppZmVqdjjkg/2pCjmVlohokKUIosoDMz9/eGPeRwBHWDwDmfe79drXnDPPffc7/kwHIeP55xbUSqVSgEAAAAoiFblHgAAAACgKSk7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQ2pR7gOagrq4ub731Vjp16pSKiopyjwMAAAB8TKlUyqxZs9KzZ8+0avXJ524oO5K89dZb6dWrV7nHAAAAAD7F5MmTs9Zaa33iOsqOJJ06dUqSTJw4MauttlqZpymP2traPPTQQxk8eHAqKyvLPU5ZyEAGiQwSGSQySGSQyCCRQSKDRAaJDBIZJDJoDmbOnJlevXrV/xv+kyg7kvpLVzp16pTOnTuXeZryqK2tTfv27dO5c+cW+xdXBjJIZJDIIJFBIoNEBokMEhkkMkhkkMggkUFz0pjbT7hBKQAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUMpadjz++OPZZ5990rNnz1RUVOTee+9t8HypVEpNTU169uyZ6urq7LLLLnnxxRcbrDN37tyccsop6dq1azp06JB99903b7zxxme4FwAAAEBzUtay47333stmm22WUaNGLfb5yy67LCNHjsyoUaPy1FNPpXv37hk0aFBmzZpVv86wYcPyq1/9KnfccUeeeOKJzJ49O1/+8pezYMGCz2o3AAAAgGakTTnffM8998yee+652OdKpVKuuuqqnHfeeTnggAOSJLfcckvWXHPNjBkzJieccEJmzJiRm266Kbfeemt23333JMltt92WXr165eGHH84ee+zxme0LAAAA0DyUtez4JBMnTszUqVMzePDg+mVVVVUZOHBgxo0blxNOOCHjx49PbW1tg3V69uyZjTfeOOPGjVti2TF37tzMnTu3/vHMmTOTJLW1tamtrV1Be9S8Ldzvlrr/iQwSGSQySGSQyCCRQSKDRAaJDBIZJDJIZJDIoDlYmuwrSqVSaQXO0mgVFRX51a9+la985StJknHjxmXHHXfMm2++mZ49e9avd/zxx2fSpEl58MEHM2bMmBxzzDENioskGTx4cPr27Zsbbrhhse9VU1OTCy+8cJHlY8aMSfv27ZtupwAAAIAmMWfOnAwZMiQzZsxI586dP3HdZntmx0IVFRUNHpdKpUWWfdynrTN8+PCcfvrp9Y9nzpyZXr16Zdddd83qq6++fAOvpGprazN27NgMGjQolZWV5R6nLGQgg0QGiQwSGSQySGSQyCCRQSKDRAaJDBIZNAcLr8pojGZbdnTv3j1JMnXq1PTo0aN++bRp07LmmmvWrzNv3rxMnz49q666aoN1dthhhyVuu6qqKlVVVYssr6ysbPHftDKQQSKDRAaJDBIZJDJIZJDIIJFBIoNEBokMEhmU09LkXtZPY/kkffv2Tffu3TN27Nj6ZfPmzctjjz1WX2RstdVWqaysbLDOlClT8sILL3xi2QEAAAAUV1nP7Jg9e3b+/ve/1z+eOHFiJkyYkNVWWy29e/fOsGHDctFFF6Vfv37p169fLrroorRv3z5DhgxJknTp0iXHHntszjjjjKy++upZbbXVcuaZZ2aTTTap/3QWAAAAoGUpa9nx9NNPZ9ddd61/vPA+GkcddVRuvvnmnH322Xn//fdz4oknZvr06dluu+3y0EMPpVOnTvWvufLKK9OmTZscfPDBef/997Pbbrvl5ptvTuvWrT/z/QEAAADKr6xlxy677JJP+jCYioqK1NTUpKamZonrtGvXLtdcc02uueaaFTAhAAAAsLJptvfsAAAAAFgWyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCafZlx6xZszJs2LD06dMn1dXV2WGHHfLUU0/VP3/00UenoqKiwdf2229fxokBAACAcmpT7gE+zde+9rW88MILufXWW9OzZ8/cdttt2X333fPSSy/lc5/7XJLkS1/6UkaPHl3/mrZt25ZrXAAAAKDMmvWZHe+//37uvvvuXHbZZdl5552z3nrrpaamJn379s11111Xv15VVVW6d+9e/7XaaquVcWoAAACgnJr1mR3z58/PggUL0q5duwbLq6ur88QTT9Q/fvTRR9OtW7esssoqGThwYEaMGJFu3botcbtz587N3Llz6x/PnDkzSVJbW5va2tom3ouVw8L9bqn7n8ggkUEig0QGiQwSGSQySGSQyCCRQSKDRAaJDJqDpcm+olQqlVbgLMtthx12SNu2bTNmzJisueaa+fnPf54jjzwy/fr1y9/+9rfceeed6dixY/r06ZOJEyfmggsuyPz58zN+/PhUVVUtdps1NTW58MILF1k+ZsyYtG/ffkXvEgAAALCU5syZkyFDhmTGjBnp3LnzJ67b7MuOf/zjHxk6dGgef/zxtG7dOltuuWX69++fZ555Ji+99NIi60+ZMiV9+vTJHXfckQMOOGCx21zcmR29evXKlClTsvrqq6+wfWnOamtrM3bs2AwaNCiVlZXlHqcsZCCDRAaJDBIZJDJIZJDIIJFBIoNEBokMEhk0BzNnzkzXrl0bVXY068tYkmTdddfNY489lvfeey8zZ85Mjx49csghh6Rv376LXb9Hjx7p06dPXn311SVus6qqarFnfVRWVrb4b1oZyCCRQSKDRAaJDBIZJDJIZJDIIJFBIoNEBokMymlpcm/WNyj9qA4dOqRHjx6ZPn16Hnzwwey3336LXe/tt9/O5MmT06NHj894QgAAAKA5aPZndjz44IMplUpZf/318/e//z1nnXVW1l9//RxzzDGZPXt2ampqcuCBB6ZHjx557bXXcu6556Zr167Zf//9yz06AAAAUAbNvuyYMWNGhg8fnjfeeCOrrbZaDjzwwIwYMSKVlZWZP39+nn/++fzsZz/Lu+++mx49emTXXXfNnXfemU6dOpV7dAAAAKAMmn3ZcfDBB+fggw9e7HPV1dV58MEHP+OJAAAAgOZspblnBwAAAEBjKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKRdkBAAAAFIqyAwAAACgUZQcAAABQKMoOAAAAoFCUHQAAAEChKDsAAACAQlF2AAAAAIWi7AAAAAAKpdmXHbNmzcqwYcPSp0+fVFdXZ4cddshTTz1V/3ypVEpNTU169uyZ6urq7LLLLnnxxRfLODEAAABQTs2+7Pja176WsWPH5tZbb83zzz+fwYMHZ/fdd8+bb76ZJLnssssycuTIjBo1Kk899VS6d++eQYMGZdasWWWeHAAAACiHZl12vP/++7n77rtz2WWXZeedd856662Xmpqa9O3bN9ddd11KpVKuuuqqnHfeeTnggAOy8cYb55ZbbsmcOXMyZsyYco8PAAAAlEGbcg/wSebPn58FCxakXbt2DZZXV1fniSeeyMSJEzN16tQMHjy4/rmqqqoMHDgw48aNywknnLDY7c6dOzdz586tfzxz5swkSW1tbWpra1fAnjR/C/e7pe5/IoNEBokMEhkkMkhkkMggkUEig0QGiQwSGSQyaA6WJvuKUqlUWoGzLLcddtghbdu2zZgxY7Lmmmvm5z//eY488sj069cvo0ePzo477pg333wzPXv2rH/N8ccfn0mTJuXBBx9c7DZrampy4YUXLrJ8zJgxad++/QrbFwAAAGDZzJkzJ0OGDMmMGTPSuXPnT1y3WZ/ZkSS33nprhg4dms997nNp3bp1ttxyywwZMiTPPPNM/ToVFRUNXlMqlRZZ9lHDhw/P6aefXv945syZ6dWrV3bdddesvvrqTb8TK4Ha2tqMHTs2gwYNSmVlZbnHKQsZyCCRQSKDRAaJDBIZJDJIZJDIIJFBIoNEBs3BwqsyGqPZlx3rrrtuHnvssbz33nuZOXNmevTokUMOOSR9+/ZN9+7dkyRTp05Njx496l8zbdq0rLnmmkvcZlVVVaqqqhZZXllZ2eK/aWUgg0QGiQwSGSQySGSQyCCRQSKDRAaJDBIZJDIop6XJvVnfoPSjOnTokB49emT69Ol58MEHs99++9UXHmPHjq1fb968eXnssceyww47lHFaAAAAoFya/ZkdDz74YEqlUtZff/38/e9/z1lnnZX1118/xxxzTCoqKjJs2LBcdNFF6devX/r165eLLroo7du3z5AhQ8o9OgAAAFAGzb7smDFjRoYPH5433ngjq622Wg488MCMGDGi/vSVs88+O++//35OPPHETJ8+Pdttt10eeuihdOrUqcyTAwAAAOXQ7MuOgw8+OAcffPASn6+oqEhNTU1qamo+u6EAAACAZmuluWcHAAAAQGMoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwAAAIBCUXYAAAAAhaLsAAAAAAplmcqO/3362Zx69gXZ79BjMuVf05Ikd//6d/nz+AlNORsAAADAUlvqsuP+h/6Qw487Oe2qqvLiy3/LvHnzkiSz35uTUTf8tMkHBAAAAFgaS112XH39Tbn4O8Nz2ffOT5s2beqXb73Fpnnh5b816XAAAAAAS2upy45/TJyU7bbZcpHlHTt2yMyZs5pkKAAAAIBltdRlR7c1uua1SZMXWf7U+Anp3etzTTIUAAAAwLJa6rLj8IMPSM1FV+TZ515IRUVF/jXtP/nVb36f71/+wxx52FdXxIwAAAAAjdbm01dp6BtfOyozZ8/OwUefkLlz5+WrRxyXtm3b5oRjDs/R/3XIipgRAAAAoNGWquxYsGBB/jx+Qo4/+vCcesKxeeUf/0xdXV36r7tOOnRov6JmBAAAAGi0pbqMpXXr1jniuFMya/bsVFe3y2Ybb5QtNt1Y0QEAAAA0G0t9z471+6+X1ye/uSJmAQAAAFhuS112nD3sxHz/8qvy8CN/zL+m/SezZs9u8AUAAABQTkt9g9IjjjslSTL0pNNTUVFRv7xUKqWioiKTXvxz000HAAAAsJSWuuy48+brV8QcAAAAAE1iqcuOz2+71YqYAwAAAKBJLHXZkSQzZs7KHXf/On//x8RUVFSk37p9c8iB+6Vzp45NPR8AAADAUlnqG5Q+98JL2WnwV/KTW8bk3Rkz8870d/PjW8Zkp8H75fkX/7oiZgQAAABotKU+s+PCS0Zm0Bd3zmXfPS9t2nz48vnz5+esC76fmouvyN23/bjJhwQAAABorKU+s+MvL7ycE792VH3RkSRt2rTJN449Mn958aUmHQ4AAABgaS112dGpY4e8OWXqIsvfmvqvdOzQoUmGAgAAAFhWS1127LPnoJx1/vdy3/0P5a0pUzNl6r/y6989mLMv+H7222uPFTEjAAAAQKMt9T07zj9rWCoqKnLaOd/J/AULkiSVbdrk8EMPzPAzTmnyAQEAAACWxlKXHW3bVubCc8/MOaednNcmv5GUSlm7d69UV7dbEfMBAAAALJWlLjtmzpqdBQsWZNVVumTD/uvVL5/+7oy0adM6nTp2bNIBAQAAAJbGUt+z46Qzzs199z+0yPLfPjA2J51+bpMMBQAAALCslrrsePYvL2SH7bZeZPnnt906z/7lxSYZCgAAAGBZLXXZMW/evPobk35U7fz5+WDuB00yFAAAAMCyWuqyY7ONN8qYu+5ZZPltd9ydTQZs2CRDAQAAACyrpb5B6dnDTsxhQ0/KS399NTt9fpskyRNPPpXnXngpt/9kVJMPCAAAALA0lvrMjm223Dy//vlP07PHmvnt7x/O2Ef+mLX7rJWx9/482229xYqYEQAAAKDRlvrMjiQZsOH6ueby7zf1LAAAAADLbanP7Hj+xb/m5Vf+Xv/4wT88mmNPPiOXXHlt5s2rbdLhAAAAAJbWUpcd59RclImvTUqSTJr8Rk46/dxUt2uX3z3wcC76wdVNPiAAAADA0ljqsmPia5Oy0QbrJ0l+98DD2W6bLTPqByMy8uLv5P6x/92kw82fPz/nn39++vbtm+rq6qyzzjr57ne/m7q6uvp1jj766FRUVDT42n777Zt0DgAAAGDlsdT37CiVktL/LxueePLP2W2XLyRJenbvnnemv9ukw1166aW5/vrrc8stt2TAgAF5+umnc8wxx6RLly755je/Wb/el770pYwePbr+cdu2bZt0DgAAAGDlsdRlx6Ybb5irr78pO31+2/zp6Wcy4jvDkySvv/Fm1lh9tSYd7sknn8x+++2XvffeO0my9tpr5+c//3mefvrpButVVVWle/fuTfreAAAAwMppqcuOmuFn5JSzzs+Df3g0p5wwNH379EqS3P/QH7LVFps26XA77bRTrr/++rzyyivp379/nnvuuTzxxBO56qqrGqz36KOPplu3bllllVUycODAjBgxIt26dVvidufOnZu5c+fWP545c2aSpLa2NrW1LfMmqwv3u6XufyKDRAaJDBIZJDJIZJDIIJFBIoNEBokMEhkkMmgOlib7ilKpVGqKN/1g7ty0btU6lZXL9Gm2i1UqlXLuuefm0ksvTevWrbNgwYKMGDEiw4cPr1/nzjvvTMeOHdOnT59MnDgxF1xwQebPn5/x48enqqpqsdutqanJhRdeuMjyMWPGpH379k02PwAAANA05syZkyFDhmTGjBnp3LnzJ67bZGXHinDHHXfkrLPOyuWXX54BAwZkwoQJGTZsWEaOHJmjjjpqsa+ZMmVK+vTpkzvuuCMHHHDAYtdZ3JkdvXr1ypQpU7L66quvkH1p7mprazN27NgMGjQolZWV5R6nLGQgg0QGiQwSGSQySGSQyCCRQSKDRAaJDBIZNAczZ85M165dG1V2NN1pGCvAWWedlXPOOSeHHnpokmSTTTbJpEmTcvHFFy+x7OjRo0f69OmTV199dYnbraqqWuxZH5WVlS3+m1YGMkhkkMggkUEig0QGiQwSGSQySGSQyCCRQSKDclqa3Jf6o2c/S3PmzEmrVg1HbN26dYOPnv24t99+O5MnT06PHj1W9HgAAABAM9Ssz+zYZ599MmLEiPTu3TsDBgzIs88+m5EjR2bo0KFJktmzZ6empiYHHnhgevTokddeey3nnntuunbtmv3337/M0wMAAADl0KzLjmuuuSYXXHBBTjzxxEybNi09e/bMCSeckG9/+9tJPjzL4/nnn8/PfvazvPvuu+nRo0d23XXX3HnnnenUqVOZpwcAAADKocnKjremTM0Vo27IFSO+01SbTKdOnXLVVVct8lGzC1VXV+fBBx9ssvcDAAAAVn5Nds+Od2fMzC/v/V1TbQ4AAABgmTT6zI6H/vuxT3z+9clvLvcwAAAAAMur0WXH104+MxUVFSmVSktcp6KiokmGAgAAAFhWjS47uq3RNd+/4Fv50u67LPb5F1/+W/b66hFNNRcAAADAMmn0PTs2GbBBXnjpr0t8/tPO+gAAAAD4LDT6zI6vDz0yc95/f4nPr927V+68+fomGQoAAABgWTW67Nhu6y0+8fn27avz+W23Wu6BAAAAAJZHoy9jmTT5DZepAAAAAM1eo8uOnb90QN5+Z3r942+cNjz//s/bK2QoAAAAgGXV6LLj42d1PPL4/3ziPTwAAAAAyqHRZQcAAADAyqDRZUdFRUUqKioWWQYAAADQnDT601hKpVJOH16Ttm3bJknmzpub4TUXp311dYP1fnzN5U07IQAAAMBSaHTZ8dWvfLnB4/332avJhwEAAABYXo0uO0Ze9J0VOQcAAABAk3CDUgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACqVZlx3z58/P+eefn759+6a6ujrrrLNOvvvd76aurq5+nVKplJqamvTs2TPV1dXZZZdd8uKLL5ZxagAAAKCcmnXZcemll+b666/PqFGj8vLLL+eyyy7L5ZdfnmuuuaZ+ncsuuywjR47MqFGj8tRTT6V79+4ZNGhQZs2aVcbJAQAAgHJp1mXHk08+mf322y9777131l577Xz1q1/N4MGD8/TTTyf58KyOq666Kuedd14OOOCAbLzxxrnlllsyZ86cjBkzpszTAwAAAOXQptwDfJKddtop119/fV555ZX0798/zz33XJ544olcddVVSZKJEydm6tSpGTx4cP1rqqqqMnDgwIwbNy4nnHDCYrc7d+7czJ07t/7xzJkzkyS1tbWpra1dcTvUjC3c75a6/4kMEhkkMkhkkMggkUEig0QGiQwSGSQySGSQyKA5WJrsK0qlUmkFzrJcSqVSzj333Fx66aVp3bp1FixYkBEjRmT48OFJknHjxmXHHXfMm2++mZ49e9a/7vjjj8+kSZPy4IMPLna7NTU1ufDCCxdZPmbMmLRv337F7AwAAACwzObMmZMhQ4ZkxowZ6dy58yeu26zP7Ljzzjtz2223ZcyYMRkwYEAmTJiQYcOGpWfPnjnqqKPq16uoqGjwulKptMiyjxo+fHhOP/30+sczZ85Mr169suuuu2b11Vdv+h1ZCdTW1mbs2LEZNGhQKisryz1OWchABokMEhkkMkhkkMggkUEig0QGiQwSGSQyaA4WXpXRGM267DjrrLNyzjnn5NBDD02SbLLJJpk0aVIuvvjiHHXUUenevXuSZOrUqenRo0f966ZNm5Y111xzidutqqpKVVXVIssrKytb/DetDGSQyCCRQSKDRAaJDBIZJDJIZJDIIJFBIoNEBuW0NLk36xuUzpkzJ61aNRyxdevW9R8927dv33Tv3j1jx46tf37evHl57LHHssMOO3ymswIAAADNQ7M+s2OfffbJiBEj0rt37wwYMCDPPvtsRo4cmaFDhyb58PKVYcOG5aKLLkq/fv3Sr1+/XHTRRWnfvn2GDBlS5ukBAACAcmjWZcc111yTCy64ICeeeGKmTZuWnj175oQTTsi3v/3t+nXOPvvsvP/++znxxBMzffr0bLfddnnooYfSqVOnMk4OAAAAlEuzLjs6deqUq666qv6jZhenoqIiNTU1qamp+czmAgAAAJqvZn3PDgAAAIClpewAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACkXZAQAAABSKsgMAAAAoFGUHAAAAUCjKDgAAAKBQlB0AAABAoSg7AAAAgEJRdgAAAACFouwAAAAACqWiVCqVyj1Euc2cOTNdunTJf/7zn6y++urlHqcsamtrc//992evvfZKZWVleYd5773kkkuSf//7M33bBXV1ef3119O7d++0btUye0AZyCCRQSKDRAaJDBIZJDJIZJDIIJFB0sIz2HTT5MQTyz1F/b/dZ8yYkc6dO3/ium0+o5mg8X75y+T73//M37Z1kr6f+bs2LzKQQSKDRAaJDBIZJDJIZJDIIJFBIoOkhWewzz7NouxYGsoOmp+33vrw1y23TPbb7zN72wULFuSVV19N/3790rp168/sfZsTGcggkUEig0QGiQwSGSQySGSQyCCRQdLCM+jfv9wTLDVlB83P229/+Ouuuybf/vZn9rZ1tbV55f77s95ee6V1uS/lKRMZyCCRQSKDRAaJDBIZJDJIZJDIIJFBIoOVTQu70IiVwsKyo4XePwUAAIDlo+yg+XnnnQ9/VXYAAACwDJQdND8Lz+xYbbXyzgEAAMBKSdlB8+MyFgAAAJaDsoPmR9kBAADAclB20LyUSu7ZAQAAwHJRdtC8zJyZLFjw4e/dswMAAIBloOygeVl4CUt19YdfAAAAsJSUHTQv7tcBAADAclJ20Ly4XwcAAADLSdlB87LwzA736wAAAGAZKTtoXlzGAgAAwHJSdtC8KDsAAABYTsoOmhdlBwAAAMtJ2UHz4galAAAALCdlB82LG5QCAACwnJQdNC8uYwEAAGA5KTtoXpQdAAAALCdlB82Le3YAAACwnJQdNB/z5yczZnz4e/fsAAAAYBkpO2g+Fp7VkSSrrlq+OQAAAFipKTtoPhber2OVVZI2bco6CgAAACsvZQfNh/t1AAAA0ASUHTQfC8/scL8OAAAAloOyg+bDx84CAADQBJQdNB/KDgAAAJqAsoPmQ9kBAABAE1B20Hy4QSkAAABNQNlB8+EGpQAAADQBZQfNh8tYAAAAaALKDpoPZQcAAABNQNlB8+GeHQAAADQBZQfNh3t2AAAA0ASUHTQPc+YkH3zw4e+d2QEAAMByUHbQPCw8q6NNm6RTp/LOAgAAwEpN2UHz8NH7dVRUlHcWAAAAVmrKDpoH9+sAAACgiSg7aB587CwAAABNpNmXHWuvvXYqKioW+TrppJOSJEcfffQiz22//fZlnpqlpuwAAACgibQp9wCf5qmnnsqCBQvqH7/wwgsZNGhQDjrooPplX/rSlzJ69Oj6x23btv1MZ6QJfPSeHQAAALAcmn3ZscYaazR4fMkll2TdddfNwIED65dVVVWle/fun/VoTWf+/OSpp/7vo1fLoGL+/HR9/vlUtG//4SeifNb+8pcPf1V2AAAAsJyafdnxUfPmzcttt92W008/PRUf+cSORx99NN26dcsqq6ySgQMHZsSIEenWrdsStzN37tzMnTu3/vHMmTOTJLW1tamtrV1xO7AErS64IK0vvfQzf9+PapNkx7JO8KEFq6ySujL8GSSp/7Mvx/dAcyEDGSQySGSQyCCRQSKDRAaJDBIZJDJIZNAcLE32FaVSqbQCZ2lSd911V4YMGZLXX389PXv2TJLceeed6dixY/r06ZOJEyfmggsuyPz58zN+/PhUVVUtdjs1NTW58MILF1k+ZsyYtG/ffoXuw+JsO2JEejz1VN5fbbXUduz4mb9/c1HboUOePfXUvNejR7lHAQAAoJmZM2dOhgwZkhkzZqRz586fuO5KVXbsscceadu2bX7zm98scZ0pU6akT58+ueOOO3LAAQcsdp3FndnRq1evTJkyJauX4TKK1rvsklbjxmX+HXektISZV7Ta2tqMHTs2gwYNSmVlZVlmKDcZyCCRQSKDRAaJDBIZJDJIZJDIIJFBIoNEBs3BzJkz07Vr10aVHSvNZSyTJk3Kww8/nHvuuecT1+vRo0f69OmTV199dYnrVFVVLfasj8rKyvJ8006fniRp061bUua/NGXLoBmRgQwSGSQySGSQyCCRQSKDRAaJDBIZJDJIZFBOS5N7s//o2YVGjx6dbt26Ze+99/7E9d5+++1Mnjw5PVamSyEWfhLJaquVdw4AAAAogJWi7Kirq8vo0aNz1FFHpc1HPilk9uzZOfPMM/Pkk0/mtddey6OPPpp99tknXbt2zf7771/GiZdCqaTsAAAAgCa0UlzG8vDDD+f111/P0KFDGyxv3bp1nn/++fzsZz/Lu+++mx49emTXXXfNnXfemU6dOpVp2qX03nvJwjvKKjsAAABgua0UZcfgwYOzuPuoVldX58EHHyzDRE3o/9+vI23bJmX4JBgAAAAompXiMpZC++glLBUV5Z0FAAAACkDZUW7u1wEAAABNStlRbsoOAAAAaFLKjnJTdgAAAECTUnaUm7IDAAAAmpSyo9yUHQAAANCklB3lpuwAAACAJqXsKDdlBwAAADQpZUe5KTsAAACgSSk7yk3ZAQAAAE1K2VFuyg4AAABoUsqOclN2AAAAQJNSdpTTBx8kc+Z8+HtlBwAAADQJZUc5TZ/+4a+tWyedO5d3FgAAACgIZUc5LbyEZdVVk4qK8s4CAAAABaHsKCf36wAAAIAmp+woJ2UHAAAANDllRzkpOwAAAKDJKTvKSdkBAAAATU7ZUU7KDgAAAGhyyo5yUnYAAABAk1N2lJOyAwAAAJqcsqOclB0AAADQ5JQd5aTsAAAAgCan7CgnZQcAAAA0OWVHOSk7AAAAoMkpO8qltjaZOfPD3ys7AAAAoMkoO8rl3Xf/7/errFKuKQAAAKBwlB3lsvASllVWSVq3LusoAAAAUCTKjnJxvw4AAABYIZQd5aLsAAAAgBVC2VEuyg4AAABYIZQd5aLsAAAAgBVC2VEuyg4AAABYIZQd5aLsAAAAgBVC2VEuyg4AAABYIZQd5aLsAAAAgBWiTbkHWKmUSk23LWUHAAAArBDKjsZ66aVk4MDkP/9p2u0qOwAAAKBJuYylsR5/vOmLju7dkwEDmnabAAAA0MI5s6OxPvjgw18POCC54Yam2WaXLkllZdNsCwAAAEii7Gi899//8NdVVkm6di3rKAAAAMCSuYylsRae2VFdXd45AAAAgE+k7GishWd2tGtX3jkAAACAT6TsaCxndgAAAMBKQdnRWM7sAAAAgJWCsqOxFp7ZoewAAACAZs2nsTSWy1gAAACW2YIFC1JbW1vuMZZZbW1t2rRpkw8++CALFiwo9ziFVVlZmdatWy/3dpQdjeUyFgAAgGUye/bsvPHGGymVSuUeZZmVSqV07949kydPTkVFRbnHKayKioqstdZa6dix43JtR9nRWM7sAAAAWGoLFizIG2+8kfbt22eNNdZYaYuCurq6zJ49Ox07dkyrVu4IsSKUSqX8+9//zhtvvJF+/fot1xkeyo7GcmYHAADAUqutrU2pVMoaa6yR6pX4fx7X1dVl3rx5adeunbJjBVpjjTXy2muvpba2drnKDn9CjeXMDgAAgGW2sp7RwWerqb5PlB2N5cwOAAAAWCkoOxrLmR0AAACwUlB2NJYzOwAAAGCloOxorIVndig7AAAACm/atGk54YQT0rt371RVVaVnz5458MAD8+STT2bevHnp2rVrvv/97y/2tRdffHG6du2aefPmJUnmzZuXyy67LJtttlnat2+frl27Zscdd8zo0aNTW1u72G08+uijqaioWOTr/PPPT5J88MEHOfroo7PJJpukTZs2+cpXvrJCclhZ+TSWxnIZCwAAQItx4IEHpra2NrfcckvWWWedTJkyJffff3/eeeedtG3bNocffnhuvvnmnHfeeYvcVHP06NE54ogj0rZt28ybNy977LFHnnvuuXzve9/LjjvumM6dO+dPf/pTfvCDH2SLLbbI5ptvvsQ5/va3v6Vz5871jzt27Jjkw4/0ra6uzqmnnpq77757hWSwvObNm5e2bduW5b2d2dEYpZIzOwAAAJpCqZS89155vkqlRo347rvv5oknnsill16aXXfdNX369Mm2226b008/PXvvvXeS5Nhjj80//vGPPP744w1e+8c//jGvvvpqjj322CTJVVddlccffzx/+MMfctJJJ2XzzTfPOuuskyFDhuR///d/069fv0+cpVu3bunevXv918Kyo0OHDrnuuuty3HHHpXv37o3ar3nz5uXkk09Ojx490q5du6y99tq5+OKLG+z38ccfnzXXXDPt2rXLxhtvnN/+9rf1z999990ZMGBAqqqqsvbaa+eKK65osP2111473//+93P00UenS5cuOe6445Ik48aNy84775zq6ur06tUrp556at57771GzbysnNnRGHPn/t/vndkBAACw7ObMSf7/P9g/c7NnJx06fOpqHTt2TMeOHXPvvfdm++23T1VV1SLrbLLJJtlmm20yevToDBw4sH75T3/602y77bbZeOONkyS33357dt9992yxxRaLbKOysjKVlZXLsUNL5+qrr859992Xu+66K717987kyZMzefLkJEldXV323HPPzJo1K7fddlvWXXfdvPTSS2ndunWSZPz48Tn44INTU1OTQw45JOPGjcuJJ56Y1VdfPUcffXT9e1x++eW54IIL6i+3ef7557PHHnvke9/7Xm666ab8+9//zsknn5yTTz45o0ePXmH7quxojIU3J02c2QEAAFBwbdq0yc0335zjjjsu119/fbbccsvsvPPO2XvvvbPDDjvUrzd06NCceeaZGTVqVDp27JjZs2fnF7/4RUaOHFm/zquvvppddtllmWdZa621GjyeNGlSVl999WXa1uuvv55+/fplp512SkVFRfr06VP/3MMPP5w///nPefnll9O/f/8kyTrrrFP//MiRI7PbbrvlggsuSJL0798/L730Ui6//PIGZccXv/jFnHnmmfWPjzzyyAwZMiTDhg1LkvTr1y9XX311Bg4cmOuuuy7tVtC/sV3G0hgLL2Fp3Tr5DFs3AACAwmnf/sMzLMrx1b59o8c88MAD89Zbb+W+++7LHnvskcceeyy77LJLbr755vp1DjvssNTV1eXOO+9Mktx5550plUo59NBD69cplUqL3NNjafzxj3/MhAkT6r9WXXXVZd7W0UcfnQkTJmT99dfPqaeemoceeqj+uQkTJmSttdaqLzo+7uWXX86OO+7YYNmOO+6YV199NQsWLKhftvXWWzdYZ/z48bn55pvrz5bp2LFj9thjj9TV1WXixInLvC+fxpkdjeFjZwEAAJpGRUWjLiVpDtq1a5dBgwZl0KBBOf/883P00UfnwgsvzNChQ5MkXbp0yVe/+tWMHj06xx57bEaPHp2vfvWrDW4o2r9//7z88svLPEPfvn2zyiqrLO+uJEm23HLLTJw4Mb///e/z8MMP5+CDD87uu++eX/7yl6n+lFs2LK60KS3mHigdPvZnW1dXlxNOOCGnnnrqIuv27t17GfaicZzZ0Rg+iQUAAKDFW3/99Re5seaxxx6b//mf/8lvf/vb/M///E/9jUkXGjJkSB5++OE8++yzi2xv/vz5K/xGnR/XuXPnHHLIIfnxj3+cO++8M3fffXfeeeedbLrppnnjjTfyyiuvLPZ1G220UZ544okGy8aNG5f+/fvX39djcbbccsu8+OKLWW+99Rb5WpGf1KLsaAyfxAIAANBivP322/niF7+Y2267LX/5y18yceLE/OIXv8jVV1+dfffdt8G6AwcOzHrrrZcjjzwy6623XnbeeecGzw8bNiw77rhjdtttt1x77bV57rnn8s9//jN33XVXtttuu7z66qvLPOdLL72UCRMm5J133smMGTPqL3VZkiuvvDJ33HFH/vrXv+aVV17JL37xi3Tv3j2rrLJKBg4cmJ133jkHHnhgxo4dW38GyAMPPJAkOeOMM/KHP/wh3/ve9/LKK6/klltuyahRoxrcn2NxvvWtb+XJJ5/MSSedlAkTJuTVV1/Nfffdl1NOOWWZ97sxXMbSGC5jAQAAaDE6duyY7bbbLldeeWX+8Y9/pLa2Nr169cqRRx6ZmpqaRdYfOnRozj333Jx11lmLPFdVVZWxY8fmyiuvzA033JAzzzwz7du3z4YbbphTTz21/lNblsVee+2VSZMm1T9e+Ikvi7u8ZOF+XXrppXn11VfTunXrbLPNNrn//vvTqtWH50HcfffdOfPMM3PYYYflvffey3rrrZdLLrkkyYdnaNx111359re/ne9973vp0aNHvvvd7za4OenibLrppnnsscdy3nnn5Qtf+EJKpVLWXXfdHHLIIcu8342h7GgMl7EAAAC0GFVVVbn44otz8cUX1y+rq6vLzJkzF3tvi+HDh2f48OGfuL1zzjkn55xzTqNn2GWXXZZYWiz02muvNXp7SXLcccfluOOOW+Lzq622Wn76058u8fkDDzwwBx544FLPs8022zS4GepnwWUsjeHMDgAAAFhpKDsaw5kdAAAAsNJQdjSGMzsAAABgpaHsaAxndgAAAMBKQ9nRGM7sAAAAWC6fdrNNSJru+0TZ0RjO7AAAAFgmrVu3TpLMmzevzJOwMlj4fbLw+2ZZ+ejZxlhYdjizAwAAYKm0adMm7du3z7///e9UVlamVauV8/+519XVZd68efnggw9W2n1o7urq6vLvf/877du3T5s2y1dXKDsaw2UsAAAAy6SioiI9evTIxIkTM2nSpHKPs8xKpVLef//9VFdXp6KiotzjFFarVq3Su3fv5c5Y2dEYLmMBAABYZm3btk2/fv1W6ktZamtr8/jjj2fnnXdOZWVluccprLZt2zbJmTPNvuxYe+21F9v+nXjiibn22mtTKpVy4YUX5sYbb8z06dOz3Xbb5dprr82AAQOabghndgAAACyXVq1apd1K/G+q1q1bZ/78+WnXrp2yYyXQ7C80euqppzJlypT6r7FjxyZJDjrooCTJZZddlpEjR2bUqFF56qmn0r179wwaNCizZs1quiGc2QEAAAArjWZfdqyxxhrp3r17/ddvf/vbrLvuuhk4cGBKpVKuuuqqnHfeeTnggAOy8cYb55ZbbsmcOXMyZsyYphvCmR0AAACw0mj2ZcdHzZs3L7fddluGDh2aioqKTJw4MVOnTs3gwYPr16mqqsrAgQMzbty4pntjZ3YAAADASqPZ37Pjo+699968++67Ofroo5MkU6dOTZKsueaaDdZbc801P/Euv3Pnzs3cuXPrH8+YMSNJ8s477yx2/dazZqVVkvm1tSm9/fZy7EHzVVtbmzlz5uTtt99usdefyUAGiQwSGSQySGSQyCCRQSKDRAaJDBIZJDJoDhberqJUKn3quitV2XHTTTdlzz33TM+ePRss//hH0pRKpU/8mJqLL744F1544SLL+/fv/8kDnHjih18AAABAWcyaNStdunT5xHVWmrJj0qRJefjhh3PPPffUL+vevXuSD8/w6NGjR/3yadOmLXK2x0cNHz48p59+ev3jd999N3369Mnrr7/+qYEV1cyZM9OrV69Mnjw5nTt3Lvc4ZSEDGSQySGSQyCCRQSKDRAaJDBIZJDJIZJDIoDkolUqZNWvWIidALM5KU3aMHj063bp1y957712/rG/fvunevXvGjh2bLbbYIsmH9/V47LHHcumlly5xW1VVVamqqlpkeZcuXVr8N23nzp1lIAMZRAaJDBIZJDJIZJDIIJFBIoNEBokMEhmUW2NPUFgpyo66urqMHj06Rx11VNq0+b+RKyoqMmzYsFx00UXp169f+vXrl4suuijt27fPkCFDyjgxAAAAUC4rRdnx8MMP5/XXX8/QoUMXee7ss8/O+++/nxNPPDHTp0/Pdtttl4ceeiidOnUqw6QAAABAua0UZcfgwYOXeLfVioqK1NTUpKamZpm3X1VVle985zuLvbSlpZCBDBIZJDJIZJDIIJFBIoNEBokMEhkkMkhkkMhgZVNRasxntgAAAACsJFqVewAAAACApqTsAAAAAApF2QEAAAAUirIDAAAAKJQWX3b86Ec/St++fdOuXbtstdVW+eMf/1jukVaYiy++ONtss006deqUbt265Stf+Ur+9re/NVinVCqlpqYmPXv2THV1dXbZZZe8+OKLZZp4xbv44otTUVGRYcOG1S9rCRm8+eabOfzww7P66qunffv22XzzzTN+/Pj654uewfz583P++eenb9++qa6uzjrrrJPvfve7qaurq1+naBk8/vjj2WeffdKzZ89UVFTk3nvvbfB8Y/Z37ty5OeWUU9K1a9d06NAh++67b954443PcC+WzydlUFtbm29961vZZJNN0qFDh/Ts2TNHHnlk3nrrrQbbKHIGH3fCCSekoqIiV111VYPlLSGDl19+Ofvuu2+6dOmSTp06Zfvtt8/rr79e/3zRM5g9e3ZOPvnkrLXWWqmurs6GG26Y6667rsE6K3sGTfUz0cqcw6dl0BKOi435PvioIh4XG5tBkY+LjcmgJRwXi6hFlx133nlnhg0blvPOOy/PPvtsvvCFL2TPPfds8Be3SB577LGcdNJJ+dOf/pSxY8dm/vz5GTx4cN577736dS677LKMHDkyo0aNylNPPZXu3btn0KBBmTVrVhknXzGeeuqp3Hjjjdl0000bLC96BtOnT8+OO+6YysrK/P73v89LL72UK664Iqusskr9OkXP4NJLL83111+fUaNG5eWXX85ll12Wyy+/PNdcc039OkXL4L333stmm22WUaNGLfb5xuzvsGHD8qtf/Sp33HFHnnjiicyePTtf/vKXs2DBgs9qN5bLJ2UwZ86cPPPMM7ngggvyzDPP5J577skrr7ySfffdt8F6Rc7go+6999787//+b3r27LnIc0XP4B//+Ed22mmnbLDBBnn00Ufz3HPP5YILLki7du3q1yl6BqeddloeeOCB3HbbbXn55Zdz2mmn5ZRTTsmvf/3r+nVW9gya6meilTmHT8ugJRwXG/N9sFBRj4uNyaDox8XGZNASjouFVGrBtt1229LXv/71Bss22GCD0jnnnFOmiT5b06ZNKyUpPfbYY6VSqVSqq6srde/evXTJJZfUr/PBBx+UunTpUrr++uvLNeYKMWvWrFK/fv1KY8eOLQ0cOLD0zW9+s1QqtYwMvvWtb5V22mmnJT7fEjLYe++9S0OHDm2w7IADDigdfvjhpVKp+BkkKf3qV7+qf9yY/X333XdLlZWVpTvuuKN+nTfffLPUqlWr0gMPPPCZzd5UPp7B4vz5z38uJSlNmjSpVCq1nAzeeOON0uc+97nSCy+8UOrTp0/pyiuvrH+uJWRwyCGH1B8LFqclZDBgwIDSd7/73QbLttxyy9L5559fKpWKl0GptGw/ExUth49nsDhFPy4uKYOWdFxcXAYt7bi4uAxa4nGxCFrsmR3z5s3L+PHjM3jw4AbLBw8enHHjxpVpqs/WjBkzkiSrrbZakmTixImZOnVqg0yqqqoycODAwmVy0kknZe+9987uu+/eYHlLyOC+++7L1ltvnYMOOijdunXLFltskR//+Mf1z7eEDHbaaaf84Q9/yCuvvJIkee655/LEE09kr732StIyMvioxuzv+PHjU1tb22Cdnj17ZuONNy5kJsmHx8iKior6s55aQgZ1dXU54ogjctZZZ2XAgAGLPF/0DOrq6vK73/0u/fv3zx577JFu3bplu+22a3CZR9EzSD48Rt5333158803UyqV8sgjj+SVV17JHnvskaSYGSzLz0RFy+HjGSxpnSIfFxeXQUs7Ln48g5Z4XFzc90FLPC4WQYstO/7zn/9kwYIFWXPNNRssX3PNNTN16tQyTfXZKZVKOf3007PTTjtl4403TpL6/S56JnfccUeeeeaZXHzxxYs81xIy+Oc//5nrrrsu/fr1y4MPPpivf/3rOfXUU/Ozn/0sScvI4Fvf+lYOO+ywbLDBBqmsrMwWW2yRYcOG5bDDDkvSMjL4qMbs79SpU9O2bdusuuqqS1ynSD744IOcc845GTJkSDp37pykZWRw6aWXpk2bNjn11FMX+3zRM5g2bVpmz56dSy65JF/60pfy0EMPZf/9988BBxyQxx57LEnxM0iSq6++OhtttFHWWmuttG3bNl/60pfyox/9KDvttFOS4mWwrD8TFSmHxWXwcUU/Li4pg5Z0XFxcBi3tuLik74OWdlwsijblHqDcKioqGjwulUqLLCuik08+OX/5y1/yxBNPLPJckTOZPHlyvvnNb+ahhx5qcJ3hxxU5g7q6umy99da56KKLkiRbbLFFXnzxxVx33XU58sgj69crcgZ33nlnbrvttowZMyYDBgzIhAkTMmzYsPTs2TNHHXVU/XpFzmBxlmV/i5hJbW1tDj300NTV1eVHP/rRp65flAzGjx+fH/7wh3nmmWeWen+KksHCmxTvt99+Oe2005Ikm2++ecaNG5frr78+AwcOXOJri5JB8uEP9X/6059y3333pU+fPnn88cdz4oknpkePHoucEflRK2sGTf0z0cqYwydlkLSM4+LiMmhpx8XFZdDSjotL+rvQ0o6LRdFiz+zo2rVrWrduvUjTNm3atEVa/KI55ZRTct999+WRRx7JWmutVb+8e/fuSVLoTMaPH59p06Zlq622Sps2bdKmTZs89thjufrqq9OmTZv6/SxyBj169MhGG23UYNmGG25Yf2PelvB9cNZZZ+Wcc87JoYcemk022SRHHHFETjvttPqzfVpCBh/VmP3t3r175s2bl+nTpy9xnSKora3NwQcfnIkTJ2bs2LH1//cyKX4Gf/zjHzNt2rT07t27/vg4adKknHHGGVl77bWTFD+Drl27pk2bNp96jCxyBu+//37OPffcjBw5Mvvss0823XTTnHzyyTnkkEPygx/8IEmxMlien4mKksOSMlioJRwXl5RBSzouLimDlnRcXFIGLe24WCQttuxo27Ztttpqq4wdO7bB8rFjx2aHHXYo01QrVqlUysknn5x77rkn//3f/52+ffs2eL5v377p3r17g0zmzZuXxx57rDCZ7Lbbbnn++eczYcKE+q+tt946//Vf/5UJEyZknXXWKXwGO+644yIfp/XKK6+kT58+SVrG98GcOXPSqlXDw1/r1q3r/+9FS8jgoxqzv1tttVUqKysbrDNlypS88MILhclk4Q/0r776ah5++OGsvvrqDZ4vegZHHHFE/vKXvzQ4Pvbs2TNnnXVWHnzwwSTFz6Bt27bZZpttPvEYWfQMamtrU1tb+4nHyCJk0BQ/E63sOXxaBknxj4uflkFLOC5+WgYt4bj4aRm0lONiIX0GN0Fttu64445SZWVl6aabbiq99NJLpWHDhpU6dOhQeu2118o92grxjW98o9SlS5fSo48+WpoyZUr915w5c+rXueSSS0pdunQp3XPPPaXnn3++dNhhh5V69OhRmjlzZhknX7E++mkspVLxM/jzn/9catOmTWnEiBGlV199tXT77beX2rdvX7rtttvq1yl6BkcddVTpc5/7XOm3v/1taeLEiaV77rmn1LVr19LZZ59dv07RMpg1a1bp2WefLT377LOlJKWRI0eWnn322fo76jdmf7/+9a+X1lprrdLDDz9ceuaZZ0pf/OIXS5tttllp/vz55dqtpfJJGdTW1pb23Xff0lprrVWaMGFCg2Pk3Llz67dR5AwW5+OfOlAqFT+De+65p1RZWVm68cYbS6+++mrpmmuuKbVu3br0xz/+sX4bRc9g4MCBpQEDBpQeeeSR0j//+c/S6NGjS+3atSv96Ec/qt/Gyp5BU/1MtDLn8GkZtITjYmO+Dz6uaMfFxmRQ9ONiYzJoCcfFImrRZUepVCpde+21pT59+pTatm1b2nLLLT/x47ZWdkkW+zV69Oj6derq6krf+c53St27dy9VVVWVdt5559Lzzz9fvqE/Ax8vO1pCBr/5zW9KG2+8camqqqq0wQYblG688cYGzxc9g5kzZ5a++c1vlnr37l1q165daZ111imdd955DX54K1oGjzzyyGL//h911FGlUqlx+/v++++XTj755NJqq61Wqq6uLn35y18uvf7662XYm2XzSRlMnDhxicfIRx55pH4bRc5gcRb3Q31LyOCmm24qrbfeeqV27dqVNttss9K9997bYBtFz2DKlCmlo48+utSzZ89Su3btSuuvv37piiuuKNXV1dVvY2XPoKl+JlqZc/i0DFrCcbEx3wcfV7TjYmMzKPJxsTEZtITjYhFVlEql0rKcEQIAAADQHLXYe3YAAAAAxaTsAAAAAApF2QEAAAAUirIDAAAAKBRlBwAAAFAoyg4AAACgUJQdAAAAQKEoOwCAJZr85lvpteHWefHlv5V7lHp//+dr2feQo7PeZjtkj/2HlHucz9STf346vTbcOjNmzir3KADQrCk7AKAZO214TXptuHWu/fHNDZY/8PCj6bXh1uUZqsyuuOaGtG9fnUfvvzt3/PRH5R5nhTnoyONTc9EVDZZttflmGf/4A+ncqWOZpgKAlYOyAwCauaqqqlz3k1vy7oyZ5R6lycybV7vMr500+Y1ss+XmWetzPbLqqqs03VCfkdra+cv82rZtK9Ntja6pqKhowokAoHiUHQDQzH3h89tmja6r59obRy9xnZGjbljkko6f3DImn99tn/rHpw2vybEnn5FrbvhptthpcAZsu0uuvPbGzJ8/P9+//IfZePsvZptd9sodd/96ke3//Z+v5SuHDc16m+2Q3b58cJ7889MNnn/l7//MkcefmvW3+kK22Glwvnn2BXln+rv1zx905PE5/3uX5sJLRmbTz++WIceetNj9qKury1XX/jjb7LJX1t3089lj/yF55I/j6p/vteHWef7Fl3PVj36cXhtunZGjbljsdma/915OOev89N9yp2z1hT3y45tvX+RMiXnzajPi8h9m64F7pv+WO2WfQ45qsF93/eo3GbDtLnn0iSez695fzfpbfSGHH3dK/jXtPw3e68577suue3816222Q3bZ68DcMuYX9c8tvAzoN78fm4OOPD7rbbZD7vnN/Zk+/d2cdMa52WaXvdJvix2z+76H5N7fPdDgz+pPTz2Tm279eXptuHV6bbh1Jr/51mIvY7n/oT9kty8fnHU3/Xw+v9s+uWH0bQ3m+/xu++SaG36aM867MBtstXO2++Leuf2uexrkcP73Ls1WX9gj6222Qz6/2z4Z9QnfawCwMlB2AEAz16p1q5w97KSMvv2uTJn6r+Xa1rg/PZ1/Tft3fnnrjbngW6dl5Kgbc/Q3TkuXzp3ymztuzuGHHJBzL7w4b02Z2uB1I35wdY4/5r/y+3tuz1ZbbJqhJ56R6f+/zPjXtP/koCOPz0Ybrp/f/eLW3Hrj1fn32+/kG6ed02Abv7z3d2nTunV+NeamXHLhuYud76af/Tw33nxbzj/rm3no1z/PwB23z7EnnZ6Jr72eJBn/+APpv946Of6YwzP+8QdywjFHLHY7373kyjz9zHP56bUjc/tN1+bP4yfkhZca3nfkjPMuzNPPPpdrr7goD917R/beY/cccdyp9e+VJO9/8EFu/OmtuerS7+aXP/tx3poyNd+//Kr658fc9atcdtWPcvY3T8x//+4X+dawk/KDq6/PL+79bYP3uviKazL08EPz37/7RQbu9Pl8MG9eNhmwYW6+7so8fN+d+a+D98+wb30nzz73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\n",
      "text/plain": [
       "<Figure size 1300x700 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "y_graph = np.array(y_ax)\n",
    "x_graph = np.arange(0, n_generations)\n",
    "\n",
    "plt.figure(figsize=(13,7))\n",
    "plt.ylim((70, 101))\n",
    "plt.xlim(right=n_generations+10)\n",
    "plt.xticks(np.arange(0, n_generations, step=20))\n",
    "plt.plot(x_graph, y_graph, '-r', label='SVC F1 score')\n",
    "plt.xlabel('Number of generations', color='#1C2833')\n",
    "plt.ylabel('F1 score', color='#1C2833')\n",
    "plt.legend(loc='lower right')\n",
    "plt.grid()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "colab": {
   "collapsed_sections": [],
   "name": "Speed_Dating_Experiment.ipynb",
   "provenance": [],
   "toc_visible": true
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.8"
  },
  "toc-showmarkdowntxt": false,
  "toc-showtags": false
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
